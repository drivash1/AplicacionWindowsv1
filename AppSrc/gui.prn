Compiling Program: C:\GIT\guiProgram\AppSrc\gui.src
Memory Available: 2147483646
1>//**************************************************************
1>// WindowsProject.tpl for Spanish translated by Moose Software (www.moose-software.com) 
1>// 28/10/2008 revised for VDF 14.1 by Moose Software  
1>// 13/07/2010 Revised for VDF 16.0 by Moose Software
1>// 05/02/2012 Revised for VDF 17.0 by Moose Software
1>// 13/06/2013 Revised for VDF 17.1 by Moose Software
1>// 02/05/2014 Revised for VDF 18.0 by Moose Software
1>//*************************************************************************************
1>Use DFAllEnt.pkg
Using pre-compiled package DFALLENT.PKG
Including file: dfallent.pkd    (C:\Program Files (x86)\DataFlex 18.2\Pkg\dfallent.pkd)
75288>Use cCJStandardCommandBarSystem.pkg
Including file: cCJStandardCommandBarSystem.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJStandardCommandBarSystem.pkg)
75288>>>// these are all the packages used in a standard MDI menubar/toolbar system
75288>>>
75288>>>Use cCJCommandBarSystem.pkg
75288>>>Use cCJStandardMenuItemClasses.pkg
Including file: cCJStandardMenuItemClasses.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJStandardMenuItemClasses.pkg)
75288>>>>>Use Dfpanel.pkg
75288>>>>>Use cCJCommandBarSystem.pkg
75288>>>>>Use LanguageText.pkg
75288>>>>>
75288>>>>>
75288>>>>>Class cCJUndoMenuItem is a cCJMenuItem
75289>>>>>    
75289>>>>>    Procedure Construct_Object
75291>>>>>        Forward Send Construct_Object
75293>>>>>        Set psCaption   to C_$CaptionUndo
75294>>>>>        Set psToolTip to C_$ToolTipUndo
75295>>>>>        Set psDescription to C_$DescUndo
75296>>>>>        Set psImage to "ActionUndo.ico"
75297>>>>>        Set pbActiveUpdate to True
75298>>>>>        Set psCategory to C_$CategoryEdit
75299>>>>>        Set psShortcut to C_$Key_Ctrl_Z
75300>>>>>    End_Procedure
75301>>>>>
75301>>>>>    Procedure OnExecute Variant vCommandBarControl
75303>>>>>        Send Undo of (focus(Self))
75304>>>>>    End_Procedure
75305>>>>>    
75305>>>>>    Function IsEnabled Returns Boolean
75307>>>>>        Boolean bEnabled
75307>>>>>        Get CanUndo of (Focus(Self)) to bEnabled
75308>>>>>        Function_Return bEnabled
75309>>>>>    End_Function
75310>>>>>         
75310>>>>>End_Class
75311>>>>>
75311>>>>>
75311>>>>>Class cCJDeleteEditMenuItem is a cCJMenuItem
75312>>>>>    
75312>>>>>    Procedure Construct_Object
75314>>>>>        Forward Send Construct_Object
75316>>>>>        Set psCaption   to C_$CaptionDelete
75317>>>>>        Set psToolTip to C_$ToolTipDelete
75318>>>>>        Set psDescription to C_$DescDelete
75319>>>>>        Set psImage to "actionDelete.ico"
75320>>>>>        Set psShortcut to C_$Key_Delete
75321>>>>>        Set pbActiveUpdate to True
75322>>>>>        Set psCategory to C_$CategoryEdit
75323>>>>>    End_Procedure
75324>>>>>
75324>>>>>
75324>>>>>    Procedure OnExecute Variant vCommandBarControl
75326>>>>>        Send Delete of (focus(Self))
75327>>>>>    End_Procedure
75328>>>>>    
75328>>>>>    Function IsEnabled Returns Boolean
75330>>>>>        Boolean bEnabled
75330>>>>>        Get CanDelete of (Focus(Self)) to bEnabled
75331>>>>>        Function_Return bEnabled
75332>>>>>    End_Function
75333>>>>>         
75333>>>>>End_Class
75334>>>>>
75334>>>>>
75334>>>>>Class cCJCutMenuItem is a cCJMenuItem
75335>>>>>    
75335>>>>>    Procedure Construct_Object
75337>>>>>        Forward Send Construct_Object
75339>>>>>        Set psCaption   to C_$CaptionCut
75340>>>>>        Set psToolTip to C_$TooltipCut
75341>>>>>        Set psDescription to C_$DescCut
75342>>>>>        Set psImage to "actionCut.ico"
75343>>>>>        Set psShortcut to C_$Key_Ctrl_X
75344>>>>>        Set pbActiveUpdate to True
75345>>>>>        Set psCategory to C_$CategoryEdit
75346>>>>>    End_Procedure
75347>>>>>
75347>>>>>
75347>>>>>    Procedure OnExecute Variant vCommandBarControl
75349>>>>>        Send Cut of (focus(Self))
75350>>>>>    End_Procedure
75351>>>>>    
75351>>>>>    Function IsEnabled Returns Boolean
75353>>>>>        Boolean bEnabled
75353>>>>>        Get CanCut of (Focus(Self)) to bEnabled
75354>>>>>        Function_Return bEnabled
75355>>>>>    End_Function
75356>>>>>         
75356>>>>>End_Class
75357>>>>>
75357>>>>>
75357>>>>>Class cCJCopyMenuItem is a cCJMenuItem
75358>>>>>    
75358>>>>>    Procedure Construct_Object
75360>>>>>        Forward Send Construct_Object
75362>>>>>        Set psCaption   to C_$CaptionCopy
75363>>>>>        Set psToolTip to C_$ToolTipCopy
75364>>>>>        Set psDescription to C_$DescCopy
75365>>>>>        Set psImage to "actionCopy.ico"
75366>>>>>        Set psShortcut to C_$Key_Ctrl_C
75367>>>>>        Set pbActiveUpdate to True
75368>>>>>        Set psCategory to C_$CategoryEdit
75369>>>>>    End_Procedure
75370>>>>>
75370>>>>>
75370>>>>>    Procedure OnExecute Variant vCommandBarControl
75372>>>>>        Send Copy of (focus(Self))
75373>>>>>    End_Procedure
75374>>>>>    
75374>>>>>    Function IsEnabled Returns Boolean
75376>>>>>        Boolean bEnabled
75376>>>>>        Get CanCopy of (Focus(Self)) to bEnabled
75377>>>>>        Function_Return bEnabled
75378>>>>>    End_Function
75379>>>>>         
75379>>>>>End_Class
75380>>>>>
75380>>>>>
75380>>>>>Class cCJPasteMenuItem is a cCJMenuItem
75381>>>>>    
75381>>>>>    Procedure Construct_Object
75383>>>>>        Forward Send Construct_Object
75385>>>>>        Set psCaption   to C_$CaptionPaste
75386>>>>>        Set psToolTip to C_$ToolTipPaste
75387>>>>>        Set psDescription to C_$DescPaste
75388>>>>>        Set psImage to "actionPaste.ico"
75389>>>>>        Set pbActiveUpdate to True
75390>>>>>        Set psShortcut to C_$Key_Ctrl_V
75391>>>>>        Set psCategory to C_$CategoryEdit
75392>>>>>    End_Procedure
75393>>>>>
75393>>>>>
75393>>>>>    Procedure OnExecute Variant vCommandBarControl
75395>>>>>        Send Paste of (focus(Self))
75396>>>>>    End_Procedure
75397>>>>>    
75397>>>>>    Function IsEnabled Returns Boolean
75399>>>>>        Boolean bEnabled
75399>>>>>        Get CanPaste of (Focus(Self)) to bEnabled
75400>>>>>        Function_Return bEnabled
75401>>>>>    End_Function
75402>>>>>         
75402>>>>>End_Class
75403>>>>>
75403>>>>>Class cCJSelectAllMenuItem is a cCJMenuItem
75404>>>>>    
75404>>>>>    Procedure Construct_Object
75406>>>>>        Forward Send Construct_Object
75408>>>>>        Set psCaption   to C_$CaptionSelectAll
75409>>>>>        Set psToolTip to C_$ToolTipSelectAll
75410>>>>>        Set psDescription to C_$DescSelectAll
75411>>>>>        Set pbActiveUpdate to True
75412>>>>>        Set psShortcut to C_$Key_Ctrl_A
75413>>>>>        Set psCategory to C_$CategoryEdit
75414>>>>>    End_Procedure
75415>>>>>
75415>>>>>
75415>>>>>    Procedure OnExecute Variant vCommandBarControl
75417>>>>>        Send Select_All of (focus(Self))
75418>>>>>    End_Procedure
75419>>>>>    
75419>>>>>    Function IsEnabled Returns Boolean
75421>>>>>        Boolean bEnabled
75421>>>>>        Get CanSelect of (Focus(Self)) to bEnabled
75422>>>>>        Function_Return bEnabled
75423>>>>>    End_Function
75424>>>>>         
75424>>>>>End_Class
75425>>>>>
75425>>>>> 
75425>>>>>Class cCJExitMenuItem is a cCJMenuItem
75426>>>>>
75426>>>>>    Procedure Construct_Object
75428>>>>>        Forward Send Construct_Object
75430>>>>>        Set psCaption to C_$CaptionExit
75431>>>>>        Set psToolTip to C_$ToolTipExit
75432>>>>>        Set psDescription to C_$ToolTipExit
75433>>>>>        Set psShortcut to C_$Key_Alt_F4
75434>>>>>        Set psCategory to C_$CategoryFile
75435>>>>>    End_Procedure
75436>>>>>
75436>>>>>    Procedure OnExecute Variant vCommandBarControl
75438>>>>>        Send Exit_Application of Desktop
75439>>>>>    End_Procedure
75440>>>>>
75440>>>>>End_Class           
75441>>>>>
75441>>>>>Class cCJHelpMenuItem is a cCJMenuItem    
75442>>>>>
75442>>>>>    Procedure Construct_Object
75444>>>>>        Forward Send Construct_Object
75446>>>>>        Set psCaption to C_$CaptionHelp
75447>>>>>        Set psDescription to C_$ToolTipHelp
75448>>>>>        Set psToolTip to C_$DescHelp
75449>>>>>        Set psImage to "ActionHelp.ico"
75450>>>>>        Set psShortcut to "F1"
75451>>>>>        Set psCategory to C_$CategoryHelp
75452>>>>>    End_Procedure
75453>>>>>    
75453>>>>>    Procedure OnExecute Variant vCommandBarControl
75455>>>>>        Send Help of (Focus(Self))
75456>>>>>    End_Procedure
75457>>>>>
75457>>>>>End_Class
75458>>>>>
75458>>>>>Class cCJStatusbarMenuItem is a cCJMenuItem
75459>>>>>
75459>>>>>    Procedure Construct_Object
75461>>>>>        Forward Send Construct_Object
75463>>>>>        Set psCaption to C_$CaptionAddStatusbar
75464>>>>>        Set psToolTip to C_$ToolTipAddStatusbar
75465>>>>>        Set psDescription to  C_$DescAddStatusbar
75466>>>>>        Set psCategory to C_$CategoryWindow
75467>>>>>    End_Procedure
75468>>>>>
75468>>>>>    Procedure OnExecute Variant vCommandBarControl
75470>>>>>        Handle hoCommandBars hoClientArea
75470>>>>>        Get CommandBarSystemObject to hoCommandBars
75471>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75472>>>>>        If hoClientArea Begin
75474>>>>>            // the clientarea's parent panel has message
75474>>>>>            Send Toggle_StatusBar of (Parent(hoClientArea))
75475>>>>>        End
75475>>>>>>
75475>>>>>    End_Procedure
75476>>>>>
75476>>>>>     Function IsChecked Returns Boolean
75478>>>>>        Boolean bOn
75478>>>>>        Handle hoCommandBars hoClientArea
75478>>>>>        Get CommandBarSystemObject to hoCommandBars
75479>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75480>>>>>        If hoClientArea Begin
75482>>>>>            // the clientarea's parent panel has message
75482>>>>>            Get StatusBar_State of (Parent(hoClientArea)) to bOn
75483>>>>>        End
75483>>>>>>
75483>>>>>        Function_Return bOn
75484>>>>>     End_Function
75485>>>>>End_Class
75486>>>>>
75486>>>>>Class cCJAutoArrangeIconsMenuItem is a cCJMenuItem
75487>>>>>
75487>>>>>    Procedure Construct_Object
75489>>>>>        Forward Send Construct_Object
75491>>>>>        Set psCaption to C_$CaptionAutoArrangeIcons
75492>>>>>        Set psToolTip to C_$ToolTipAutoArrangeIcons
75493>>>>>        Set psDescription to C_$DescAutoArrangeIcons
75494>>>>>        Set psCategory to C_$CategoryWindow
75495>>>>>    End_Procedure
75496>>>>>
75496>>>>>    Procedure OnExecute Variant vCommandBarControl
75498>>>>>        Handle hoCommandBars hoClientArea
75498>>>>>        Get CommandBarSystemObject to hoCommandBars
75499>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75500>>>>>        If hoClientArea Begin
75502>>>>>            // the clientarea's parent panel has message
75502>>>>>            Send Toggle_Auto_Arrange_Icons of (Parent(hoClientArea))
75503>>>>>        End
75503>>>>>>
75503>>>>>    End_Procedure
75504>>>>>    
75504>>>>>     Function IsChecked Returns Boolean
75506>>>>>        Boolean bOn
75506>>>>>        Handle hoCommandBars hoClientArea
75506>>>>>        Get CommandBarSystemObject to hoCommandBars
75507>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75508>>>>>        If hoClientArea Begin
75510>>>>>            // the clientarea's parent panel has message
75510>>>>>            Get Auto_Arrange_Icons_State of (Parent(hoClientArea)) to bOn
75511>>>>>        End
75511>>>>>>
75511>>>>>        Function_Return bOn
75512>>>>>     End_Function
75513>>>>>End_Class
75514>>>>>
75514>>>>>Class cCJRestoreMenusMenuItem is a cCJMenuItem
75515>>>>>
75515>>>>>    Procedure Construct_Object
75517>>>>>        Forward Send Construct_Object
75519>>>>>        Set psCaption to C_$CaptionRestoreMenus
75520>>>>>        Set psToolTip to C_$ToolTipRestoreMenus
75521>>>>>        Set psDescription to C_$DescRestoreMenus
75522>>>>>        Set psCategory to C_$CategoryWindow
75523>>>>>    End_Procedure
75524>>>>>
75524>>>>>    Procedure OnExecute Variant vCommandBarControl
75526>>>>>        Handle hoCommandBars
75526>>>>>        Get CommandBarSystemObject to hoCommandBars
75527>>>>>        Send RestoreLayout of hoCommandBars
75528>>>>>    End_Procedure
75529>>>>>    
75529>>>>>End_Class
75530>>>>>
75530>>>>>Class cCJCascadeMenuItem is a cCJMenuItem
75531>>>>>
75531>>>>>    Procedure Construct_Object
75533>>>>>        Forward Send Construct_Object
75535>>>>>        Set psCaption to C_$CaptionCascade
75536>>>>>        Set psToolTip to C_$ToolTipCascade
75537>>>>>        Set psDescription to  C_$DescCascade
75538>>>>>        Set psImage to "ActionCascade.ico"
75539>>>>>        Set psCategory to C_$CategoryWindow
75540>>>>>    End_Procedure
75541>>>>>    
75541>>>>>    Procedure OnExecute Variant vCommandBarControl
75543>>>>>        Handle hoCommandBars hoClientArea
75543>>>>>        Get CommandBarSystemObject to hoCommandBars
75544>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75545>>>>>        If hoClientArea Begin
75547>>>>>            Send Cascade_Windows of hoClientArea
75548>>>>>        End
75548>>>>>>
75548>>>>>    End_Procedure
75549>>>>>End_Class
75550>>>>>
75550>>>>>Class cCJTileHorizontally is a cCJMenuItem
75551>>>>>
75551>>>>>    Procedure Construct_Object
75553>>>>>        Forward Send Construct_Object
75555>>>>>        Set psCaption to C_$CaptionTileHorizontally 
75556>>>>>        Set psToolTip to C_$ToolTipTileHorizontally  
75557>>>>>        Set psDescription to  C_$DescTileHorizontally
75558>>>>>        Set psImage to "ActionTileHorizontally.ico"
75559>>>>>        Set psCategory to C_$CategoryWindow
75560>>>>>    End_Procedure
75561>>>>>
75561>>>>>    Procedure OnExecute Variant vCommandBarControl
75563>>>>>        Handle hoCommandBars hoClientArea
75563>>>>>        Get CommandBarSystemObject to hoCommandBars
75564>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75565>>>>>        If hoClientArea Begin
75567>>>>>            Send Tile_Windows_Horizontal of hoClientArea
75568>>>>>        End
75568>>>>>>
75568>>>>>    End_Procedure
75569>>>>>End_Class
75570>>>>>
75570>>>>>Class cCJTileVertically is a cCJMenuItem
75571>>>>>
75571>>>>>    Procedure Construct_Object
75573>>>>>        Forward Send Construct_Object
75575>>>>>        Set psCaption to C_$CaptionTileVertically  
75576>>>>>        Set psToolTip to C_$ToolTipTileVertically
75577>>>>>        Set psDescription to  C_$DescTileVertically
75578>>>>>        Set psImage to "ActionTileVertically.ico"
75579>>>>>        Set psCategory to C_$CategoryWindow
75580>>>>>    End_Procedure
75581>>>>>
75581>>>>>    Procedure OnExecute Variant vCommandBarControl
75583>>>>>        Handle hoCommandBars hoClientArea
75583>>>>>        Get CommandBarSystemObject to hoCommandBars
75584>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75585>>>>>        If hoClientArea Begin
75587>>>>>            Send Tile_Windows_Vertical of hoClientArea
75588>>>>>        End
75588>>>>>>
75588>>>>>    End_Procedure
75589>>>>>End_Class
75590>>>>>
75590>>>>>Class cCJMinimizeWindowsMenuItem is a cCJMenuItem
75591>>>>>
75591>>>>>    Procedure Construct_Object
75593>>>>>        Forward Send Construct_Object
75595>>>>>        Set psCaption to C_$CaptionMinimizeWindows 
75596>>>>>        Set psToolTip to C_$ToolTipMinimizeWindows
75597>>>>>        Set psDescription to  C_$DescMinimizeWindows
75598>>>>>        Set psCategory to C_$CategoryWindow
75599>>>>>    End_Procedure
75600>>>>>
75600>>>>>    Procedure OnExecute Variant vCommandBarControl
75602>>>>>        Handle hoCommandBars hoClientArea
75602>>>>>        Get CommandBarSystemObject to hoCommandBars
75603>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75604>>>>>        If hoClientArea Begin
75606>>>>>            // the clientarea's parent panel has message
75606>>>>>            Send Minimize_all_Windows of (Parent(hoClientArea))
75607>>>>>        End
75607>>>>>>
75607>>>>>    End_Procedure
75608>>>>>End_Class
75609>>>>>
75609>>>>>
75609>>>>>Class cCJRestoreWindowsMenuItem is a cCJMenuItem
75610>>>>>
75610>>>>>    Procedure Construct_Object
75612>>>>>        Forward Send Construct_Object
75614>>>>>        Set psCaption to C_$CaptionRestoreWindows
75615>>>>>        Set psToolTip to C_$ToolTipRestoreWindows
75616>>>>>        Set psDescription to  C_$DescRestoreWindows
75617>>>>>        Set psCategory to C_$CategoryWindow
75618>>>>>    End_Procedure
75619>>>>>
75619>>>>>    Procedure OnExecute Variant vCommandBarControl
75621>>>>>        Handle hoCommandBars hoClientArea
75621>>>>>        Get CommandBarSystemObject to hoCommandBars
75622>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75623>>>>>        If hoClientArea Begin
75625>>>>>            // the clientarea's parent panel has message
75625>>>>>            Send Restore_all_Windows of (Parent(hoClientArea))
75626>>>>>        End
75626>>>>>>
75626>>>>>    End_Procedure
75627>>>>>End_Class
75628>>>>>
75628>>>>>Class cCJArrangeIconsMenuItem is a cCJMenuItem
75629>>>>>
75629>>>>>    Procedure Construct_Object
75631>>>>>        Forward Send Construct_Object
75633>>>>>        Set psCaption to C_$CaptionArrangeIcons  
75634>>>>>        Set psToolTip to C_$ToolTipArrangeIcons
75635>>>>>        Set psDescription to  C_$DescArrangeIcons
75636>>>>>        Set psCategory to C_$CategoryWindow
75637>>>>>    End_Procedure
75638>>>>>
75638>>>>>    Procedure OnExecute Variant vCommandBarControl
75640>>>>>        Handle hoCommandBars hoClientArea
75640>>>>>        Get CommandBarSystemObject to hoCommandBars
75641>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75642>>>>>        If hoClientArea Begin
75644>>>>>            Send Arrange_Icons of hoClientArea
75645>>>>>        End
75645>>>>>>
75645>>>>>    End_Procedure
75646>>>>>
75646>>>>>End_Class
75647>>>>>    
75647>>>Use cCJAboutMenuItem.pkg
Including file: cCJAboutMenuItem.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJAboutMenuItem.pkg)
75647>>>>>Use cCJCommandBarSystem.pkg
75647>>>>>Use LanguageText.pkg
75647>>>>>
75647>>>>>// It is expected that if you use this class that you provide an about object that is
75647>>>>>// activated via activate_about such as DfAbout.pkg. We don't use this for you automatically
75647>>>>>// because you may wish to create your own custom about package.
75647>>>>>
75647>>>>>Class cCJAboutMenuItem is a cCJMenuItem    
75648>>>>>
75648>>>>>    Procedure Construct_Object
75650>>>>>        Forward Send Construct_Object
75652>>>>>        Set psCaption to C_$CaptionAbout
75653>>>>>        Set psDescription to C_$ToolTipAbout
75654>>>>>        Set psToolTip to C_$DescAbout
75655>>>>>        Set psImage to "ActionAbout.ico"
75656>>>>>        Set psCategory to C_$CategoryHelp
75657>>>>>    End_Procedure
75658>>>>>    
75658>>>>>    Procedure OnExecute Variant vCommandBarControl
75660>>>>>        Handle hoCommandBars hoClientArea
75660>>>>>        Get CommandBarSystemObject to hoCommandBars
75661>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75662>>>>>        If hoClientArea Begin
75664>>>>>            Send Activate_About of hoClientArea
75665>>>>>        End
75665>>>>>>
75665>>>>>    End_Procedure
75666>>>>>
75666>>>>>End_Class
75667>>>>>
75667>>>>>
75667>>>Use cCJDeoMenuItemClasses.pkg
75667>>>Use cCJMDIWindowsMenuItem.pkg
Including file: cCJMDIWindowsMenuItem.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJMDIWindowsMenuItem.pkg)
75667>>>>>Use cCJCommandBarSystem.pkg
75667>>>>>
75667>>>>>Register_Function Client_ID Returns Integer
75667>>>>>
75667>>>>>// only used by cCJMDIWIndowsMenuItem
75667>>>>>Class cCJMDIWindowItem is a cCJMenuItem
75668>>>>>
75668>>>>>    Procedure Construct_Object
75670>>>>>        Forward Send Construct_Object
75672>>>>>        Property Handle phWindow 0 // object id of view
75673>>>>>        Set pbControlFlagNoMovable to True
75674>>>>>        Set pbActiveUpdate to True
75675>>>>>    End_Procedure
75676>>>>>    
75676>>>>>    Procedure OnExecute Variant vCommandBarControl
75678>>>>>        Handle hWindow
75678>>>>>        Get phWindow to hWindow
75679>>>>>        Send Activate_View of hWindow
75680>>>>>    End_Procedure
75681>>>>>    
75681>>>>>End_Class                
75682>>>>>
75682>>>>>
75682>>>>>Class cCJMDIWindowsMenuItem is a cCJMenuItem
75683>>>>>    
75683>>>>>    Procedure Construct_Object
75685>>>>>        Forward Send Construct_Object
75687>>>>>        Property Handle[] phArrayOfWindows
75688>>>>>        Set peControlType to xtpControlPopup
75689>>>>>        Set psCategory to C_$CategoryWindow
75690>>>>>    End_Procedure
75691>>>>>    
75691>>>>>     // This adds MDI windows to the existing menu items.
75691>>>>>     // This removes any existing windows menus and always adds a new set to the end
75691>>>>>
75691>>>>>     Procedure OnPopupInit Variant vCommandBarControl Handle hCommandBarControls
75693>>>>>        Handle  hClientArea hView
75693>>>>>        String  sLabel
75693>>>>>        Integer i iWindows
75693>>>>>        Handle[] hArrayOfWindows
75694>>>>>        Variant vItem
75694>>>>>        
75694>>>>>        // delete all windows actions and menu items. Assume we have an array of DF action objects for the windows
75694>>>>>        // also assume that destroying an action removes all menu instances of that action
75694>>>>>        Get phArrayOfWindows to hArrayOfWindows
75695>>>>>        Move (SizeOfArray(hArrayOfWindows)) to iWindows
75696>>>>>        For i from 0 to (iWindows-1)
75702>>>>>>
75702>>>>>            Send Destroy of hArrayOfWindows[i] // assume this removes all menu items of this action
75703>>>>>        Loop
75704>>>>>>
75704>>>>>        Move (ResizeArray(hArrayOfWindows,0)) to hArrayOfWindows
75705>>>>>
75705>>>>>        // Add all views to this menu. Create the action and add the item
75705>>>>>        Move 0 to i
75706>>>>>        Get Client_Id to hClientArea // object id of client area
75707>>>>>        If (hClientArea > 0) Begin
75709>>>>>            Get Next_Mdi_Dialog of hClientArea True to hView // find first view
75710>>>>>            While (hView <> 0)
75714>>>>>                If (Active_State(hView)) Begin
75716>>>>>                    // create the action
75716>>>>>                    Get Create U_cCJMDIWindowItem to hArrayOfWindows[i]
75717>>>>>                    Get Label of hView to sLabel // caption bar (name) of view
75718>>>>>                    Set psCaption of hArrayOfWindows[i] to sLabel
75719>>>>>                    Set psDescription of hArrayOfWindows[i] to ("Make this view (" - trim(sLabel) - ") the active window.")
75720>>>>>                    If (current_scope(desktop)=hView and View_mode(hView)<>VIEWMODE_ICONIZE) Begin
75722>>>>>                        Set pbChecked of hArrayOfWindows[i] to True
75723>>>>>                    End
75723>>>>>>
75723>>>>>                    Set phWindow of hArrayOfWindows[i] to hView // used by custom OnExecute
75724>>>>>                    If (i=0) Begin
75726>>>>>                        Set pbControlBeginGroup of hArrayOfWindows[i] to True
75727>>>>>                    End
75727>>>>>>
75727>>>>>                    // Create a menu item for this action
75727>>>>>                    Get AddDynamicControl of hArrayOfWindows[i] hCommandBarControls to vItem
75728>>>>>                    Increment i
75729>>>>>                End
75729>>>>>>
75729>>>>>                Get Next_Mdi_Dialog of hClientArea False to hView // find next
75730>>>>>            Loop
75731>>>>>>
75731>>>>>        End
75731>>>>>>
75731>>>>>
75731>>>>>        Set phArrayOfWindows to hArrayOfWindows
75732>>>>>
75732>>>>>     End_Procedure
75733>>>>>     
75733>>>>>End_Class
75734>>>>>
75734>
75734>Object oHtmlHelp is a cHtmlHelp
75736>End_Object
75737>
75737>Object oApplication is a cApplication
75739>    Set peHelpType to htHtmlHelp
75740>End_Object
75741>
75741>Object oToolTipController is a cToolTipController
75743>    Move Self to ghoToolTipController
75744>End_Object
75745>
75745>Use oEditContextMenu.pkg
Including file: oEditContextMenu.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\oEditContextMenu.pkg)
75745>>>Use cCJStandardMenuItemClasses.pkg
75745>>>
75745>>>Object oEditContextMenu is a cCJContextMenu
75747>>>    
75747>>>    Move Self to Default_Form_Floating_Menu_ID
75748>>>    
75748>>>    Object oUndoMenuItem is a cCJUndoMenuItem
75750>>>    End_Object
75751>>>    
75751>>>    Object oCutMenuItem is a cCJCutMenuItem
75753>>>        Set pbControlBeginGroup to True
75754>>>    End_Object
75755>>>    
75755>>>    Object oCopyMenuItem is a cCJCopyMenuItem
75757>>>    End_Object
75758>>>
75758>>>    Object oPasteMenuItem is a cCJPasteMenuItem
75760>>>    End_Object
75761>>>
75761>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
75763>>>    End_Object
75764>>>
75764>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
75766>>>        Set pbControlBeginGroup to True
75767>>>    End_Object
75768>>>
75768>>>End_Object
75769>>>
75769>Use oDEOEditContextMenu17.pkg
Including file: oDEOEditContextMenu17.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\oDEOEditContextMenu17.pkg)
75769>>>Use Windows.pkg
75769>>>Use cCJStandardMenuItemClasses.pkg
75769>>>Use cCJDeoMenuItemClasses.pkg
75769>>>
75769>>>
75769>>>Object oDEOEditContextMenu17 is a cCJContextMenu
75771>>>    
75771>>>    Move Self to Default_dbFloating_Menu_ID
75772>>>    
75772>>>    Object oUndoMenuItem is a cCJUndoMenuItem
75774>>>    End_Object
75775>>>    
75775>>>    Object oCutMenuItem is a cCJCutMenuItem
75777>>>        Set pbControlBeginGroup to True
75778>>>    End_Object
75779>>>    
75779>>>    Object oCopyMenuItem is a cCJCopyMenuItem
75781>>>    End_Object
75782>>>
75782>>>    Object oPasteMenuItem is a cCJPasteMenuItem
75784>>>    End_Object
75785>>>
75785>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
75787>>>    End_Object
75788>>>
75788>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
75790>>>        Set pbControlBeginGroup to True
75791>>>    End_Object
75792>>>
75792>>>    Object oPromptMenuItem is a cCJPromptMenuItem
75794>>>        Set pbControlBeginGroup to True
75795>>>    End_Object
75796>>>
75796>>>    Object oFindNextMenu is a cCJFindNextMenuItem
75798>>>        Set pbControlBeginGroup to True
75799>>>    End_Object
75800>>>
75800>>>    Object oFindPreviousMenu is a cCJFindPreviousMenuItem
75802>>>    End_Object
75803>>>
75803>>>    Object oClearMenuItem is a cCJClearMenuItem
75805>>>        Set pbControlBeginGroup to True
75806>>>    End_Object
75807>>>
75807>>>    Object oClearAllMenu is a cCJClearAllMenuItem
75809>>>    End_Object
75810>>>
75810>>>    Object oSaveMenu is a cCJSaveMenuItem
75812>>>    End_Object
75813>>>    
75813>>>    Object oDeleteMenu is a cCJDeleteMenuItem
75815>>>    End_Object
75816>>>
75816>>>    Object oRememberitem is a cCJRememberFieldMenuItem
75818>>>        Set pbControlBeginGroup to True
75819>>>    End_Object
75820>>>
75820>>>    Object oRetainItem is a cCJRememberLastFieldMenuItem
75822>>>    End_Object
75823>>>
75823>>>    Object oUnRememberitem is a cCJUnRememberFieldMenuItem
75825>>>    End_Object
75826>>>
75826>>>    Object oCJClearAllDynamicDefaults is a cCJUnRememberFieldAllMenuItem
75828>>>    End_Object
75829>>>
75829>>>End_Object
75830>
75830>Object oMain is a Panel
75832>    Set Label to "Mi Proyecto"
75833>    Set Location to 4 3
75834>    Set Size to 300 450
75835>
75835>    Object oCommandBarSystem is a cCJCommandBarSystem
75837>        Set pbTimerUpdate to True
75838>
75838>        Procedure OnCreateCommandBars
75841>            Handle hoOptions
75841>            Get OptionsObject to hoOptions
75842>            Forward Send OnCreateCommandBars
75844>        End_Procedure
75845>
75845>        Object oMenuBar is a cCJMenuBar
75847>
75847>            Object oViewMenu is a cCJMenuItem
75849>                Set peControlType to xtpControlPopup
75850>                Set psCaption to "&Vistas"
75851>                Set psToolTip to "Programa"
75852>               Set psDescription to "Vistas disponibles"
75853>
75853>               Object opantallaPrincipalMenuItem is a cCJMenuItem
75855>                   Set psCaption to "Login"
75856>                   Set psTooltip to "Login"
75857>               
75857>                   Procedure OnExecute Variant vCommandBarControl
75860>                       Handle hoClient
75860>                       Get Client_Id to hoClient
75861>                       Send Activate_oPantallaPrincipal of hoClient
75862>                   End_Procedure
75863>               End_Object
75864>            End_Object
75865>
75865>        End_Object
75866>        
75866>        Object oStatusBar is a cCJStatusBar
75868>
75868>            Object oStatusPane1 is a cCJStatusBarPane
75870>                Set piID to sbpIDIdlePane
75871>                Set pbStyleStretch to True
75872>            End_Object
75873>
75873>            Object oStatusPane2 is a cCJStatusBarPane
75875>                Set phoViewPane to Self
75876>                Set pbStyleStretch to True
75877>            End_Object
75878>
75878>        End_Object
75879>
75879>    End_Object
75880>
75880>    Object oClientArea is a ClientArea
75882>        Use StdAbout.pkg
Including file: StdAbout.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\StdAbout.pkg)
75882>>>//************************************************************************
75882>>>// Confidential Trade Secret.
75882>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
75882>>>// as an unpublished work.  All rights reserved.
75882>>>// DataFlex is a registered trademark of Data Access Corporation.
75882>>>//
75882>>>//************************************************************************
75882>>>//************************************************************************
75882>>>//
75882>>>// $File name  : StdAbout.pkg
75882>>>// $File title : Standard about object package for VDF
75882>>>// Notice      :
75882>>>// $Author(s)  : John Tuohy
75882>>>//
75882>>>// $Rev History
75882>>>//
75882>>>// JT 06/27/97   File created
75882>>>//************************************************************************
75882>>>
75882>>>// This provides a quick and simple way to create an about package for a program.
75882>>>// You need to create a message inside you client area called Activate_About.
75882>>>// Within this message you should send the message DoAbout passing needed
75882>>>// string information.
75882>>>//
75882>>>//       Procedure Activate_About
75882>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
75882>>>//       End_Procedure
75882>>>//    where: sTitle =     Name of application. If none provided, uses caption
75882>>>//                        bar title
75882>>>//           sVersion   = Version Line. If none provided, will be blank
75882>>>//           sCopyRight = Copyright Line. If none provided, will be blank
75882>>>//           sAuthor    = Author name, blank if none provided
75882>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
75882>>>//                        is used.
75882>>>// It is expected that you will place this in your own object package. For
75882>>>// example an order about package may look like this:
75882>>>//
75882>>>//   // OrderAbout.pkg
75882>>>//   Use StdAbout.pkg
75882>>>//   Procedure Activate_About
75882>>>//      String sTitle sCopyright sVersion sAuthor
75882>>>//      Move "My Order Entry System" to sTitle
75882>>>//      Move "Version 2.1" to sVersion
75882>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
75882>>>//      Move "John Smith"  to sAuthor
75882>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
75882>>>//   end_procedure
75882>>>//   // end of file.
75882>>>
75882>>>Use DfAbout.pkg
Including file: Dfabout.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\Dfabout.pkg)
75882>>>>>//************************************************************************
75882>>>>>// Confidential Trade Secret.
75882>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
75882>>>>>// as an unpublished work.  All rights reserved.
75882>>>>>// DataFlex Is A registered trademark Of Data Access Corporation.
75882>>>>>//
75882>>>>>//************************************************************************
75882>>>>>//************************************************************************
75882>>>>>//
75882>>>>>// $File name  : DfAbout.pkg
75882>>>>>// $File title : About class support
75882>>>>>// Notice      :
75882>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
75882>>>>>//
75882>>>>>// $Rev History
75882>>>>>//
75882>>>>>// VOO 02/22/2012 Replaced obsolete code, improved Network_User_Name by asking
75882>>>>>//                Windows for the size first. 
75882>>>>>// VOO 07/25/2003 Removed OnResize procedure for sysinfo dialog. Replaced logic
75882>>>>>//                with anchor technique. Removed unnessary property in the
75882>>>>>//                sysinfo dialog. Changed the size Of the about & sysinfo dialog
75882>>>>>//                object To better look in Windows XP. Repositioned the close
75882>>>>>//                button in the sysinfo dialog To line up with the display area
75882>>>>>//                Replaced obsolete code and techniques. Removed dead code.
75882>>>>>// JJT 10/23/2001 removed all ghoworkspace support. Uses app object or nothing
75882>>>>>// SWB 07/19/01   Added support Of the Application object in preference to
75882>>>>>//                the global Workspace object, if it is present
75882>>>>>// JJT 11/05/98   Added version information
75882>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
75882>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
75882>>>>>//                workspace package.
75882>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
75882>>>>>//                class can create this object.
75882>>>>>//                Cleaned up the interface (used correct classes and messages)
75882>>>>>//                Added workspace reporting support To sys-info.
75882>>>>>//                Turned off wrapping in the sys-info editor.
75882>>>>>// KR  ??/??/96   File created
75882>>>>>//************************************************************************
75882>>>>>Use LanguageText.pkg
75882>>>>>Use Windows.pkg
75882>>>>>Use DFbitmap.pkg
75882>>>>>Use GlobalFunctionsProcedures.pkg
75882>>>>>Use cTextEdit.pkg
75882>>>>>
75882>>>>>Use cli.pkg
Including file: cli.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cli.pkg)
75882>>>>>>>//*****************************************************************************
75882>>>>>>>//*** CLI.PKG                                                               ***
75882>>>>>>>//***                                                                       ***
75882>>>>>>>//*** Author: Ben Weijers                                                   ***
75882>>>>>>>//***         Data Access Nederland                                         ***
75882>>>>>>>//***         10 September 1998                                             ***
75882>>>>>>>//***                                                                       ***
75882>>>>>>>//*** Purpose:                                                              ***
75882>>>>>>>//***   CLI specific functionality. There are several connectivity kits     ***
75882>>>>>>>//***   based on  SQL/92 CLI. Those are:                                    ***
75882>>>>>>>//***    - ODBC_DRV  The Data Access CK for ODBC                            ***
75882>>>>>>>//***    - DB2_DRV   The Data Access CK for DB2                             ***
75882>>>>>>>//***    - MSSQLDRV  The Data Access CK for Microsoft SQL Server            ***
75882>>>>>>>//***                                                                       ***
75882>>>>>>>//***   This package defines the common functionality for all CLI based     ***
75882>>>>>>>//***   drivers.                                                            ***
75882>>>>>>>//***                                                                       ***
75882>>>>>>>//***   Updated:  May 23rd 2008 (Current CK build: 5.0.0.53 )               ***
75882>>>>>>>//***             Added NULLABLE and DEFAULT attributes for DATETIME type   ***
75882>>>>>>>//***   Updated:  Apr  6th 2009 (Current CK build: 5.0.0.61 )               ***
75882>>>>>>>//***             Added DF_DRIVER_MATCH_CLIENT_SERVER_VERSION attribute     ***
75882>>>>>>>//***                   DF_DRIVER_SQLSERVER_CLIENT_VERSION    attribute     ***
75882>>>>>>>//***   Updated:  Mar 30th 2012 (Current CK build: 5.1.0.93 )               ***
75882>>>>>>>//***             Added SQLSERVER2012CLIENT return value for                ***
75882>>>>>>>//***             DF_DRIVER_SQLSERVER_CLIENT_VERSION attribute              ***
75882>>>>>>>//***   Updated:  June 4th 2012 (Current CK build: 5.1.0.96)                ***
75882>>>>>>>//***             Moved SQL Server client constants from cli.pkg to         ***
75882>>>>>>>//***             mssqldrv.pkg                                              ***
75882>>>>>>>//***   Updated:  april 23, 2013 (Current CK build: 6.0.0.4)                ***
75882>>>>>>>//***             Added type mappings attributes                            ***
75882>>>>>>>//***   Updated:  october 11, 2013 (Current CK build: 6.0.0.18)             ***
75882>>>>>>>//***             Added DF_FILE_SQL_FILTER_EQ attribute                     ***
75882>>>>>>>//*****************************************************************************
75882>>>>>>>
75882>>>>>>>//*** We are not using ifndef below because that is not supported in Character Mode
75882>>>>>>>//*** Driver attributes
75882>>>>>>>
75882>>>>>>>
75882>>>>>>>
75882>>>>>>>
75882>>>>>>>
75882>>>>>>>
75882>>>>>>>
75882>>>>>>>
75882>>>>>>>
75882>>>>>>>//------------------------------------------------------------
75882>>>>>>>
75882>>>>>>>
75882>>>>>>>//-------------------------------------
75882>>>>>>>
75882>>>>>>>
75882>>>>>>>
75882>>>>>>>//*** Replacement for logical column number that indicates all columns
75882>>>>>>>
75882>>>>>>>//*** Possible DF_FILE_GENERATE_RECORD_ID_METHOD values
75882>>>>>>>
75882>>>>>>>//*** Possible DF_FIELD_READ_ONLY values
75882>>>>>>>
75882>>>>>>>
75882>>>>>>>//*** Possible DF_DRIVER_DEFAULT_MAP_DF_TO_SQL_TYPE_SCHEMA values
75882>>>>>>>// #Replace MAP_DF_TO_SQL_TYPE_CK5        1       
75882>>>>>>>// #Replace MAP_DF_TO_SQL_TYPE_CK6        2   
75882>>>>>>>
75882>>>>>>>
75882>>>>>>>// Moved to Mssqldrv.pkg
75882>>>>>>>//*** Possible DF_DRIVER_SQLSERVER_CLIENT_VERSION values
75882>>>>>>>//#REPLACE SQLSERVERUNKNOWNCLIENT  0
75882>>>>>>>//#REPLACE SQLSERVER2000CLIENT     8          //   "SQL Server"
75882>>>>>>>//#REPLACE SQLSERVER2005CLIENT     9          //   "SQL Native Client"
75882>>>>>>>//#REPLACE SQLSERVER2008CLIENT    10          //   "SQL Server Native Client 10.0"
75882>>>>>>>//#Replace SQLSERVER2012CLIENT    11          //   "SQL Server Native Client 11.0"
75882>>>>>>>
75882>>>>>>>//*** Possible SQL Column type values
75882>>>>>>>Define SQL_UNKNOWN_TYPE   For    0
75882>>>>>>>Define SQL_CHAR           For    1
75882>>>>>>>Define SQL_NUMERIC        For    2
75882>>>>>>>Define SQL_DECIMAL        For    3
75882>>>>>>>Define SQL_INTEGER        For    4
75882>>>>>>>Define SQL_SMALLINT       For    5
75882>>>>>>>Define SQL_FLOAT          For    6
75882>>>>>>>Define SQL_REAL           For    7
75882>>>>>>>Define SQL_DOUBLE         For    8
75882>>>>>>>Define SQL_DATETIME       For    9
75882>>>>>>>Define SQL_VARCHAR        For   12
75882>>>>>>>Define SQL_TYPE_DATE      For   91
75882>>>>>>>Define SQL_TYPE_TIME      For   92
75882>>>>>>>Define SQL_TYPE_TIMESTAMP for   93
75882>>>>>>>// Moved to mssqldrv.pkg
75882>>>>>>>//Define SQL_TYPE_TIMESTAMP2 for   (-200) //SQL server datetime2 type */
75882>>>>>>>
75882>>>>>>>
75882>>>>>>>Define SQL_DATE           For    9
75882>>>>>>>Define SQL_INTERVAL       For   10
75882>>>>>>>Define SQL_TIME           For   10
75882>>>>>>>Define SQL_TIMESTAMP      For   11
75882>>>>>>>Define SQL_LONGVARCHAR    For  (-1)
75882>>>>>>>Define SQL_BINARY         For  (-2)
75882>>>>>>>Define SQL_VARBINARY      For  (-3)
75882>>>>>>>Define SQL_LONGVARBINARY  For  (-4)
75882>>>>>>>Define SQL_BIGINT         For  (-5)
75882>>>>>>>Define SQL_TINYINT        For  (-6)
75882>>>>>>>Define SQL_BIT            For  (-7)
75882>>>>>>>Define SQL_WCHAR          For  (-8)
75882>>>>>>>Define SQL_WVARCHAR       For  (-9)
75882>>>>>>>Define SQL_WLONGVARCHAR   For (-10)
75882>>>>>>>Define SQL_GUID           For (-11)
75882>>>>>>>
75882>>>>>>>//*** Driver level attributes
75882>>>>>>>
75882>>>>>>>
75882>>>>>>>//*** Error number constants
75882>>>>>>>
75882>>>>>>>
75882>>>>>>>//*** Call driver function identifiers
75882>>>>>>>
75882>>>>>>>
75882>>>>>>>//*** Init data source types
75882>>>>>>>
75882>>>>>>>
75882>>>>>>>//*** Dummy strings used in the commands
75882>>>>>>>    String  CLI$StrDummy 255
75882>>>>>>>    Integer CLI$IntDummy
75882>>>>>>>
75882>>>>>>>
75882>>>>>>>//*****************************************************************************
75882>>>>>>>//*** CLI_SetConstraint <FileNum> <NewState>                                ***
75882>>>>>>>//***                                                                       ***
75882>>>>>>>//***   Setup a constraint for a file.                                      ***
75882>>>>>>>//*****************************************************************************
75882>>>>>>>
75882>>>>>>>
75882>>>>>>>
75882>>>>>>>
75882>>>>>>>//*****************************************************************************
75882>>>>>>>//*** CLI_Set_Driver_Atrtribute / CLI_Get_Driver_Attribute                  ***
75882>>>>>>>//***                                                                       ***
75882>>>>>>>//*** Set or get an attribute at driver level. These attributes, when set,  ***
75882>>>>>>>//*** will be set for the remainder of the session or until set again. To   ***
75882>>>>>>>//*** permanently set driver level attributes change the driver             ***
75882>>>>>>>//*** configuration file.                                                   ***
75882>>>>>>>//*****************************************************************************
75882>>>>>>>
75882>>>>>>>
75882>>>>>>>
75882>>>>>>>
75882>>>>>>>
75882>>>>>>>
75882>>>>>>>
75882>>>>>>>//*****************************************************************************
75882>>>>>>>//*** Class  : cCLIHandler                                                  ***
75882>>>>>>>//*** Purpose: An instance of this class can be used as a broker object to  ***
75882>>>>>>>//***          call several CLI releated methods.                           ***
75882>>>>>>>//*****************************************************************************
75882>>>>>>>
75882>>>>>>>Class cCLIHandler Is An Array
75883>>>>>>>
75883>>>>>>>    Procedure Construct_Object Integer iImage
75885>>>>>>>        Forward Send Construct_object iImage
75887>>>>>>>
75887>>>>>>>        Property String  psDriverID       Public ""
75888>>>>>>>    End_Procedure // Construct_Object
75889>>>>>>>
75889>>>>>>>
75889>>>>>>>
75889>>>>>>>    //***
75889>>>>>>>    //*** Fucntion: CKRevsion
75889>>>>>>>    //*** Purpose : The revsion of a CLI Connectivity Kit
75889>>>>>>>    //***
75889>>>>>>>
75889>>>>>>>    Function CKRevision Returns String
75891>>>>>>>        Local String  sDriverID
75891>>>>>>>        Local String  sRevision
75891>>>>>>>        Local String  sVoid
75891>>>>>>>        Local Integer iRetval
75891>>>>>>>
75891>>>>>>>        Get psDriverID To sDriverID
75892>>>>>>>        If (sDRiverID <> "") Begin
75894>>>>>>>            Move (Repeat(" ", 255)) To sRevision
75895>>>>>>>            Call_Driver 0 sDRiverID Function CLI_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
75900>>>>>>>        End
75900>>>>>>>>
75900>>>>>>>
75900>>>>>>>        Function_Return sRevision
75901>>>>>>>    End_Function // CKRevision
75902>>>>>>>
75902>>>>>>>
75902>>>>>>>
75902>>>>>>>    //***
75902>>>>>>>    //*** Function: ExtractPartFromRevision
75902>>>>>>>    //*** Purpose : Extarct the Nth part of a a.b.c.d revsion string.
75902>>>>>>>    //***
75902>>>>>>>    //*** Returns : The part version number or -1 if there is no such part number.
75902>>>>>>>    //***
75902>>>>>>>
75902>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
75904>>>>>>>        Local Integer iPartRev
75904>>>>>>>        Local Integer iCurrentPart
75904>>>>>>>        Local Integer iSeparatorPos
75904>>>>>>>
75904>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
75907>>>>>>>
75907>>>>>>>        Move 0 To iCurrentPart
75908>>>>>>>        Repeat
75908>>>>>>>>
75908>>>>>>>            Move (Pos(".", sRevision)) To iSeparatorPos
75909>>>>>>>            If (iSeparatorPos > 0) Begin
75911>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) To iPartRev
75912>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) To sRevision
75913>>>>>>>                Increment iCurrentPart
75914>>>>>>>            End
75914>>>>>>>>
75914>>>>>>>            Else If (sRevision <> "") Begin
75917>>>>>>>                Move sRevision To iPartRev
75918>>>>>>>                Move "" To sRevision
75919>>>>>>>                Increment iCurrentPart
75920>>>>>>>            End
75920>>>>>>>>
75920>>>>>>>            Else ;                Move -1 To iPartRev
75922>>>>>>>        Until (iCurrentPart >= iPartNum Or iPartRev = -1)
75924>>>>>>>
75924>>>>>>>        Function_Return iPartRev
75925>>>>>>>    End_Function // EcxtractPartFromRevision
75926>>>>>>>
75926>>>>>>>
75926>>>>>>>
75926>>>>>>>    //***
75926>>>>>>>    //*** Function: CKMajorRevision
75926>>>>>>>    //*** Purpose : Returns the major revision of the CK
75926>>>>>>>    //***
75926>>>>>>>
75926>>>>>>>    Function CKMajorRevision Returns Integer
75928>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
75929>>>>>>>    End_Function // CKMajorRevision
75930>>>>>>>
75930>>>>>>>
75930>>>>>>>
75930>>>>>>>    //***
75930>>>>>>>    //*** Function: CKMinorRevision
75930>>>>>>>    //*** Purpose : Returns the minor revision of the CK
75930>>>>>>>    //***
75930>>>>>>>
75930>>>>>>>    Function CKMinorRevision Returns Integer
75932>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
75933>>>>>>>    End_Function // CKMinorRevision
75934>>>>>>>
75934>>>>>>>
75934>>>>>>>
75934>>>>>>>    //***
75934>>>>>>>    //*** Function: CKReleaseRevision
75934>>>>>>>    //*** Purpose : Returns the release revision of the CK
75934>>>>>>>    //***
75934>>>>>>>
75934>>>>>>>    Function CKReleaseRevision Returns Integer
75936>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
75937>>>>>>>    End_Function // CKReleaseRevision
75938>>>>>>>
75938>>>>>>>
75938>>>>>>>
75938>>>>>>>    //***
75938>>>>>>>    //*** Function: CKBuildRevision
75938>>>>>>>    //*** Purpose : Returns the major revision of the CK
75938>>>>>>>    //***
75938>>>>>>>
75938>>>>>>>    Function CKBuildRevision Returns Integer
75940>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
75941>>>>>>>    End_Function // CKBuildRevision
75942>>>>>>>
75942>>>>>>>
75942>>>>>>>
75942>>>>>>>    //***
75942>>>>>>>    //*** Function: IsMinimalRevision
75942>>>>>>>    //*** Purpose : Determines if the CK conforms to a passed minimal revsion.
75942>>>>>>>    //***
75942>>>>>>>
75942>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
75944>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_return (TRUE)
75947>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
75950>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_return (TRUE)
75953>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
75956>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_return (TRUE)
75959>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) And iBuild <= CKBuildRevision(Current_object)) ;                    Function_return (TRUE)
75963>>>>>>>            End
75963>>>>>>>>
75963>>>>>>>        End
75963>>>>>>>>
75963>>>>>>>
75963>>>>>>>        Function_Return (FALSE)
75964>>>>>>>    End_Function // IsMinimalRevision
75965>>>>>>>
75965>>>>>>>
75965>>>>>>>
75965>>>>>>>    //***
75965>>>>>>>    //*** Function: RegistrationName
75965>>>>>>>    //*** Purpose : Returns the Connectiivty Kit registration name.
75965>>>>>>>    //***
75965>>>>>>>
75965>>>>>>>    Function RegistrationName Returns String
75967>>>>>>>        Local String  sRegistration
75967>>>>>>>        Local String  sDRiverId
75967>>>>>>>        Local String  sVoid
75967>>>>>>>        Local Integer iRetval
75967>>>>>>>
75967>>>>>>>        Get psDriverID To sDriverID
75968>>>>>>>        If (sDRiverID <> "") Begin
75970>>>>>>>            Move (Repeat(" ", 255)) To sRegistration
75971>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETREGNAME Callback 0 Passing sRegistration sVoid 0 Result iRetval
75976>>>>>>>        End
75976>>>>>>>>
75976>>>>>>>
75976>>>>>>>        Function_Return sRegistration
75977>>>>>>>    End_Function // RegistrationName
75978>>>>>>>
75978>>>>>>>
75978>>>>>>>
75978>>>>>>>    //***
75978>>>>>>>    //*** Function: SerialNumber
75978>>>>>>>    //*** Purpose : Returns the Connectiivty Kit serial number.
75978>>>>>>>    //***
75978>>>>>>>
75978>>>>>>>    Function SerialNumber Returns Integer
75980>>>>>>>        Local String  sDRiverId
75980>>>>>>>        Local String  sVoid
75980>>>>>>>        Local Integer iRetval
75980>>>>>>>
75980>>>>>>>        Get psDriverID To sDriverID
75981>>>>>>>        If (sDRiverID <> "") Begin
75983>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETSERIALNUM Callback 0 Passing sVoid sVoid 0 Result iRetval
75988>>>>>>>        End
75988>>>>>>>>
75988>>>>>>>
75988>>>>>>>        Function_Return iRetval
75989>>>>>>>    End_Function // SerialNumber
75990>>>>>>>
75990>>>>>>>
75990>>>>>>>
75990>>>>>>>    //***
75990>>>>>>>    //*** Function: MaxUsers
75990>>>>>>>    //*** Purpose : Returns the Connectiivty Kit maximum number of users.
75990>>>>>>>    //***
75990>>>>>>>
75990>>>>>>>    Function MaxUsers Returns Integer
75992>>>>>>>        Local String  sDRiverId
75992>>>>>>>        Local String  sVoid
75992>>>>>>>        Local Integer iRetval
75992>>>>>>>
75992>>>>>>>        Get psDriverID To sDriverID
75993>>>>>>>        If (sDRiverID <> "") Begin
75995>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETMAXUSERS Callback 0 Passing sVoid sVoid 0 Result iRetval
76000>>>>>>>        End
76000>>>>>>>>
76000>>>>>>>
76000>>>>>>>        Function_Return iRetval
76001>>>>>>>    End_Function // MaxUsers
76002>>>>>>>
76002>>>>>>>
76002>>>>>>>
76002>>>>>>>    //***
76002>>>>>>>    //*** Procedure: DumpStatus
76002>>>>>>>    //*** Purpose  : Dump the current status of the drver in the passed disk file.
76002>>>>>>>    //***
76002>>>>>>>
76002>>>>>>>    Procedure DumpStatus String sFileName
76004>>>>>>>        Local String  sVoid
76004>>>>>>>        Local String  sDriverID
76004>>>>>>>        Local Integer iVoid
76004>>>>>>>
76004>>>>>>>        Get psDriverID To sDriverID
76005>>>>>>>        If (sDriverID <> "") ;            Call_driver 0 sDriverID Function CLI_DUMPSTATUS Callback 0 Passing sFileName sVoid iVoid Result iVoid
76012>>>>>>>    End_Procedure // DumpStatus
76013>>>>>>>
76013>>>>>>>
76013>>>>>>>
76013>>>>>>>    //***
76013>>>>>>>    //*** Procedure: ReadConfiguration
76013>>>>>>>    //*** Purpose  : Reset all driver level configurable attributes to the
76013>>>>>>>    //***            default value and then reread the configuration.
76013>>>>>>>    //***
76013>>>>>>>
76013>>>>>>>    Procedure ReadConfiguration
76015>>>>>>>        Local String  sVoid
76015>>>>>>>        Local String  sDriverID
76015>>>>>>>        Local Integer iVoid
76015>>>>>>>
76015>>>>>>>        Get psDriverID To sDriverID
76016>>>>>>>        If (sDriverID <> "") ;            Call_driver 0 sDriverID Function CLI_READCONFIGURATION Callback 0 Passing sVoid sVoid iVoid Result iVoid
76023>>>>>>>    End_Procedure // ReadConfiguration
76024>>>>>>>
76024>>>>>>>
76024>>>>>>>
76024>>>>>>>    //***
76024>>>>>>>    //*** Function: TextToRIMValue
76024>>>>>>>    //*** Purpose : Convert a text to the corresponding
76024>>>>>>>    //***           Generate_Record_ID_Method attribute value
76024>>>>>>>    //***
76024>>>>>>>
76024>>>>>>>    Function TextToRIMValue String sText Returns Integer
76026>>>>>>>        If (sText = "None") ;            Function_return RIM_NONE
76029>>>>>>>        Else If (sText = "Identity Column") ;            Function_return RIM_IDENTITY_COLUMN
76033>>>>>>>        Else If (sText = "Dispenser Table") ;            Function_return RIM_DISPENSER_TABLE
76037>>>>>>>        Else If (sText = "External") ;            Function_return RIM_EXTERNAL
76041>>>>>>>    End_Function // TextToRIMValue
76042>>>>>>>
76042>>>>>>>
76042>>>>>>>
76042>>>>>>>    //***
76042>>>>>>>    //*** Function: RIMValueTotext
76042>>>>>>>    //*** Purpose : Convert a Generate_Record_ID_Method attribute value to the
76042>>>>>>>    //***           corresponding text.
76042>>>>>>>    //***
76042>>>>>>>
76042>>>>>>>    Function RIMValueToText Integer iAttrValue Returns String
76044>>>>>>>        If (iAttrValue = RIM_NONE) ;            Function_return "None"
76047>>>>>>>        Else If (iAttrValue = RIM_IDENTITY_COLUMN) ;            Function_return "Identity Column"
76051>>>>>>>        Else If (iAttrValue = RIM_DISPENSER_TABLE) ;            Function_return "Dispenser Table"
76055>>>>>>>        Else If (iAttrValue = RIM_EXTERNAL) ;            Function_return "External"
76059>>>>>>>    End_Function // RIMValueToText
76060>>>>>>>
76060>>>>>>>
76060>>>>>>>
76060>>>>>>>    //***
76060>>>>>>>    //*** Function: TextToROValue
76060>>>>>>>    //*** Purpose : Convert a text to the corresponding
76060>>>>>>>    //***           Generate_Record_ID_Method attribute value
76060>>>>>>>    //***
76060>>>>>>>
76060>>>>>>>    Function TextToROValue String sText Returns Integer
76062>>>>>>>        If (sText = "No") ;            Function_return RO_NO
76065>>>>>>>        Else If (sText = "Ignore Change") ;            Function_return RO_IGNORECHANGE
76069>>>>>>>        Else If (sText = "Accept Change") ;            Function_return RO_ACCEPTCHANGE
76073>>>>>>>        Else If (sText = "Error On Change") ;            Function_return RO_ERRORONCHANGE
76077>>>>>>>    End_Function // TextToRIMValue
76078>>>>>>>
76078>>>>>>>
76078>>>>>>>
76078>>>>>>>    //***
76078>>>>>>>    //*** Function: ROValueTotext
76078>>>>>>>    //*** Purpose : Convert a Generate_Record_ID_Method attribute value to the
76078>>>>>>>    //***           corresponding text.
76078>>>>>>>    //***
76078>>>>>>>
76078>>>>>>>    Function ROValueToText Integer iAttrValue Returns String
76080>>>>>>>        If (iAttrValue = RO_NO) ;            Function_return "No"
76083>>>>>>>        Else If (iAttrValue = RO_IGNORECHANGE) ;            Function_return "Ignore Change"
76087>>>>>>>        Else If (iAttrValue = RO_ACCEPTCHANGE) ;            Function_return "Accept Change"
76091>>>>>>>        Else If (iAttrValue = RO_ERRORONCHANGE) ;            Function_return "Error On Change"
76095>>>>>>>    End_Function // RIMValueToText
76096>>>>>>>
76096>>>>>>>
76096>>>>>>>
76096>>>>>>>    //***
76096>>>>>>>    //*** Function: LastDriverError
76096>>>>>>>    //*** Purpose : Return the text f the last error geneated by the driver.
76096>>>>>>>    //***
76096>>>>>>>
76096>>>>>>>    Function LastDriverError Returns String
76098>>>>>>>        Local String  sDriverID
76098>>>>>>>        Local String  sLastError
76098>>>>>>>        Local String  sLastErrorLength
76098>>>>>>>        Local Integer iLastErrorLength
76098>>>>>>>        Local Integer iVoid
76098>>>>>>>
76098>>>>>>>        //*** Initialize
76098>>>>>>>        Move "" To sLastError
76099>>>>>>>
76099>>>>>>>        Get psDriverID To sDriverID
76100>>>>>>>        If (sDriverID <> "") Begin
76102>>>>>>>            //*** Get the text of the last error
76102>>>>>>>            Move (Repeat(Character(" "), 14)) To sLastErrorlength
76103>>>>>>>            Call_driver 0 sDriverID Function CLI_GETDRIVERATTRIBUTE Callback 0 Passing sLastErrorLength iVoid DRVR_LASTERRORTEXTLENGTH Result iVoid
76108>>>>>>>            Move (Left(sLastErrorLength, Pos(Character(0), sLastErrorLength) - 1)) To iLastErrorLength
76109>>>>>>>
76109>>>>>>>            If (iLastErrorLength > 0) Begin
76111>>>>>>>                Move (Repeat(Character(" "), iLastErrorLength + 1)) To sLastError
76112>>>>>>>                Call_driver 0 sDriverID Function CLI_GETDRIVERATTRIBUTE Callback 0 Passing sLastError iVoid DRVR_LASTERRORTEXT Result iVoid
76117>>>>>>>                Move (Left(sLastError, Pos(Character(0), sLastError) - 1)) To sLastError
76118>>>>>>>            End
76118>>>>>>>>
76118>>>>>>>        End
76118>>>>>>>>
76118>>>>>>>
76118>>>>>>>        Function_Return sLastError
76119>>>>>>>    End_Function // LastDriverError
76120>>>>>>>
76120>>>>>>>
76120>>>>>>>
76120>>>>>>>    //***
76120>>>>>>>    //*** Function: EnumerateTables
76120>>>>>>>    //*** Purpose : Enumerate the tables in a database
76120>>>>>>>    //***
76120>>>>>>>
76120>>>>>>>    Function EnumerateTables String sLogin Returns Integer
76122>>>>>>>        Local String  sDriver
76122>>>>>>>        Local String  sVoid
76122>>>>>>>        Local Integer iNumTables
76122>>>>>>>        Local Integer iVoid
76122>>>>>>>
76122>>>>>>>        Get psDriverID To sDriver
76123>>>>>>>        If (sDriver <> "") ;            Call_driver 0 sDriver Function CLI_ENUMERATE_TABLES Callback 0 Passing sLogin sVoid iVoid Result iNumTables
76130>>>>>>>
76130>>>>>>>        Function_Return iNumTables
76131>>>>>>>    End_Function // EnumerateTables
76132>>>>>>>
76132>>>>>>>
76132>>>>>>>
76132>>>>>>>    //***
76132>>>>>>>    //*** Function: TableName
76132>>>>>>>    //*** Purpose : Returns the name of the table enumerated at the given position
76132>>>>>>>    //***
76132>>>>>>>
76132>>>>>>>    Function TableName Integer iIndex Returns String
76134>>>>>>>        Local String  sDriver
76134>>>>>>>        Local String  sTableName
76134>>>>>>>        Local String  sVoid
76134>>>>>>>        Local Integer iVoid
76134>>>>>>>
76134>>>>>>>        Get psDriverID To sDriver
76135>>>>>>>        If (sDriver <> "") Begin
76137>>>>>>>            Move (Repeat(" ", 255)) To sTableName
76138>>>>>>>            Call_driver 0 sDriver Function CLI_TABLENAME Callback 0 Passing sTableName sVoid iIndex Result iVoid
76143>>>>>>>        End
76143>>>>>>>>
76143>>>>>>>
76143>>>>>>>        Function_Return sTableName
76144>>>>>>>    End_Function // TableName
76145>>>>>>>
76145>>>>>>>
76145>>>>>>>
76145>>>>>>>    //***
76145>>>>>>>    //*** Function: SchemaName
76145>>>>>>>    //*** Purpose : Returns the name of the schema of the table enumerated at the given position
76145>>>>>>>    //***
76145>>>>>>>
76145>>>>>>>    Function SchemaName Integer iIndex Returns String
76147>>>>>>>        Local String  sDriver
76147>>>>>>>        Local String  sSchemaName
76147>>>>>>>        Local String  sVoid
76147>>>>>>>        Local Integer iVoid
76147>>>>>>>
76147>>>>>>>        Get psDriverID To sDriver
76148>>>>>>>        If (sDriver <> "") Begin
76150>>>>>>>            Move (Repeat(" ", 255)) To sSchemaName
76151>>>>>>>            Call_driver 0 sDriver Function CLI_TABLESCHEMA Callback 0 Passing sSchemaName sVoid iIndex Result iVoid
76156>>>>>>>        End
76156>>>>>>>>
76156>>>>>>>
76156>>>>>>>        Function_Return sSchemaName
76157>>>>>>>    End_Function // SchemaName
76158>>>>>>>
76158>>>>>>>
76158>>>>>>>
76158>>>>>>>    //***
76158>>>>>>>    //*** Function: TableType
76158>>>>>>>    //*** Purpose : Returns the type of the table enumerated at the given position.
76158>>>>>>>    //***           Types can be "TABLE", "VIEW", "SYSTEM TABLE", "GLOBAL TEMPORARY",
76158>>>>>>>    //***           "LOCAL TEMPORARY", "ALIAS", "SYNONYM"
76158>>>>>>>    //***
76158>>>>>>>
76158>>>>>>>    Function TableType Integer iIndex Returns String
76160>>>>>>>        Local String  sDriver
76160>>>>>>>        Local String  sTableType
76160>>>>>>>        Local String  sVoid
76160>>>>>>>        Local Integer iVoid
76160>>>>>>>
76160>>>>>>>        Get psDriverID To sDriver
76161>>>>>>>        If (sDriver <> "") Begin
76163>>>>>>>            Move (Repeat(" ", 25)) To sTableType
76164>>>>>>>            Call_driver 0 sDriver Function CLI_TABLETYPE Callback 0 Passing sTableType sVoid iIndex Result iVoid
76169>>>>>>>        End
76169>>>>>>>>
76169>>>>>>>
76169>>>>>>>        Function_Return sTableType
76170>>>>>>>    End_Function // TableType
76171>>>>>>>
76171>>>>>>>
76171>>>>>>>
76171>>>>>>>    //***
76171>>>>>>>    //*** Function: TableComment
76171>>>>>>>    //*** Purpose : Returns the comment of the table enumerated at the given position
76171>>>>>>>    //***
76171>>>>>>>
76171>>>>>>>    Function TableComment Integer iIndex Returns String
76173>>>>>>>        Local String  sDriver
76173>>>>>>>        Local String  sTableComment
76173>>>>>>>        Local String  sVoid
76173>>>>>>>        Local Integer iVoid
76173>>>>>>>
76173>>>>>>>        Get psDriverID To sDriver
76174>>>>>>>        If (sDriver <> "") Begin
76176>>>>>>>            Move (Repeat(" ", 255)) To sTableComment
76177>>>>>>>            Call_driver 0 sDriver Function CLI_TABLECOMMENT Callback 0 Passing sTableComment sVoid iIndex Result iVoid
76182>>>>>>>        End
76182>>>>>>>>
76182>>>>>>>
76182>>>>>>>        Function_Return sTableComment
76183>>>>>>>    End_Function // TableComment
76184>>>>>>>
76184>>>>>>>
76184>>>>>>>
76184>>>>>>>    //***
76184>>>>>>>    //*** Function: EnumerateColumns
76184>>>>>>>    //*** Purpose : Enumerate the columns in a table
76184>>>>>>>    //***
76184>>>>>>>
76184>>>>>>>    Function EnumerateColumns String sLogin String sTableName Returns Integer
76186>>>>>>>        Local String  sDriver
76186>>>>>>>        Local Integer iNumColumns
76186>>>>>>>        Local Integer iVoid
76186>>>>>>>
76186>>>>>>>        Get psDriverID To sDriver
76187>>>>>>>        If (sDriver <> "") ;            Call_driver 0 sDriver Function CLI_ENUMERATE_COLUMNS Callback 0 Passing sLogin sTablename iVoid Result iNumColumns
76194>>>>>>>
76194>>>>>>>        Function_Return iNumColumns
76195>>>>>>>    End_Function // EnumerateColumns
76196>>>>>>>
76196>>>>>>>
76196>>>>>>>
76196>>>>>>>    //***
76196>>>>>>>    //*** Function: ColumnName
76196>>>>>>>    //*** Purpose : Returns the name of the column enumerated at the given position
76196>>>>>>>    //***
76196>>>>>>>
76196>>>>>>>    Function ColumnName Integer iIndex Returns String
76198>>>>>>>        Local String  sDriver
76198>>>>>>>        Local String  sColumnName
76198>>>>>>>        Local String  sVoid
76198>>>>>>>        Local Integer iVoid
76198>>>>>>>
76198>>>>>>>        Get psDriverID To sDriver
76199>>>>>>>        If (sDriver <> "") Begin
76201>>>>>>>            Move (Repeat(" ", 255)) To sColumnName
76202>>>>>>>            Call_driver 0 sDriver Function CLI_COLUMNNAME Callback 0 Passing sColumnName sVoid iIndex Result iVoid
76207>>>>>>>        End
76207>>>>>>>>
76207>>>>>>>
76207>>>>>>>        Function_Return sColumnName
76208>>>>>>>    End_Function // ColumnName
76209>>>>>>>
76209>>>>>>>
76209>>>>>>>
76209>>>>>>>    //***
76209>>>>>>>    //*** Function: CLIDFDateToSQLDate
76209>>>>>>>    //*** Purpose : Convert a DataFlex date to a SQL date using the dummy zero date value.
76209>>>>>>>    //***
76209>>>>>>>
76209>>>>>>>    Function CLIDFDateToSQLDate String sDRiver Date dDFDate Returns String
76211>>>>>>>        Local String sSQLDate
76211>>>>>>>        Local Integer iOrgDateFmt
76211>>>>>>>        Local Integer iOrgDateSep
76211>>>>>>>
76211>>>>>>>        //*** Change date format to military, SQL dates are military dates
76211>>>>>>>        Get_Attribute DF_DATE_FORMAT To iOrgDateFmt
76214>>>>>>>        Get_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76217>>>>>>>        Set_Attribute DF_DATE_FORMAT To DF_DATE_MILITARY
76220>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To (Ascii('-'))
76223>>>>>>>
76223>>>>>>>        //*** We only need to convert if the date is 0
76223>>>>>>>        If (Integer(dDFDate = 0)) ;            CLI_Get_Driver_Attribute sDRiver DRVR_DUMMY_ZERO_DATE_VALUE To sSQLDate
76232>>>>>>>        Else ;            Move dDFDate To sSQLDate
76234>>>>>>>
76234>>>>>>>        //*** Change date format back to original
76234>>>>>>>        Set_Attribute DF_DATE_FORMAT To iOrgDateFmt
76237>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76240>>>>>>>
76240>>>>>>>        Function_Return sSQLDate
76241>>>>>>>    End_Function // CLIDFDateToSQLDate
76242>>>>>>>
76242>>>>>>>
76242>>>>>>>
76242>>>>>>>    //***
76242>>>>>>>    //*** Function: CLISQLDateToDFDate
76242>>>>>>>    //*** Purpose : Convert a SQL date to a DataFlex date using the dummy zero date value.
76242>>>>>>>    //***
76242>>>>>>>
76242>>>>>>>    Function CLISQLDateToDFDate String sDRiver String sSQLDate Returns Date
76244>>>>>>>        Local Date dDFDate
76244>>>>>>>        Local String sDummyDateValue
76244>>>>>>>        Local Integer iOrgDateFmt
76244>>>>>>>        Local Integer iOrgDateSep
76244>>>>>>>
76244>>>>>>>        //*** Change date format to military, SQL dates are military dates
76244>>>>>>>        Get_Attribute DF_DATE_FORMAT To iOrgDateFmt
76247>>>>>>>        Get_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76250>>>>>>>        Set_Attribute DF_DATE_FORMAT To DF_DATE_MILITARY
76253>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To (Ascii('-'))
76256>>>>>>>
76256>>>>>>>        //*** We only need to convert if the date is the dummy zero date value
76256>>>>>>>        CLI_Get_Driver_Attribute sDRiver DRVR_DUMMY_ZERO_DATE_VALUE To sDummyDateValue
76263>>>>>>>        If (sDummyDateValue = sSQLDate) ;            Move 0 To dDFDate
76266>>>>>>>        Else ;            Move sSQLDate To dDFDate
76268>>>>>>>
76268>>>>>>>        //*** Change date format back to original
76268>>>>>>>        Set_Attribute DF_DATE_FORMAT To iOrgDateFmt
76271>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76274>>>>>>>
76274>>>>>>>        Function_Return dDFDate
76275>>>>>>>    End_Function // CLISQLDateToDFDate
76276>>>>>>>
76276>>>>>>>
76276>>>>>>>
76276>>>>>>>    //***
76276>>>>>>>    //*** Function: RedirectConnection
76276>>>>>>>    //*** Purpose : Redirect an exisitng connection. The existing connection
76276>>>>>>>    //***           will point to another database but all tables will stay
76276>>>>>>>    //***           open!
76276>>>>>>>    //***
76276>>>>>>>
76276>>>>>>>    Function RedirectConnection String sOldConnection String sNewConnection Returns Integer
76278>>>>>>>        Local String  sDriver
76278>>>>>>>        Local String  sVoid
76278>>>>>>>        Local Integer iResult
76278>>>>>>>        Local Integer iVoid
76278>>>>>>>
76278>>>>>>>        Get psDriverID To sDriver
76279>>>>>>>        If (sDriver <> "") Begin
76281>>>>>>>            Call_driver 0 sDriver Function CLI_REDIRECTCONNECTION Callback 0 Passing sOldConnection sNewConnection iVoid Result iResult
76286>>>>>>>        End
76286>>>>>>>>
76286>>>>>>>        Function_Return iResult
76287>>>>>>>    End_Function // RedirectConnect
76288>>>>>>>
76288>>>>>>>
76288>>>>>>>
76288>>>>>>>    //***
76288>>>>>>>    //*** Function: CreateConnectionID
76288>>>>>>>    //*** Purpose : Create a DataFlex side connection id that can be used later on.
76288>>>>>>>    //***
76288>>>>>>>
76288>>>>>>>    Function CreateConnectionID String sID String sConnStr Integer iOpt Returns Integer
76290>>>>>>>        Local String  sDriver
76290>>>>>>>        Local Integer iResult
76290>>>>>>>        Local Integer iOptions
76290>>>>>>>
76290>>>>>>>        Get psDriverID to sDriver
76291>>>>>>>        If (Num_Arguments = 2) ;            Move 0 to iOptions
76294>>>>>>>        Else ;            Move iOpt to iOptions
76296>>>>>>>        If (sDriver <> "") Begin
76298>>>>>>>            Call_Driver 0 sDriver Function CLI_CREATECONNECTIONID Callback 0 Passing sID sConnStr iOptions Result iResult
76303>>>>>>>        End
76303>>>>>>>>
76303>>>>>>>        Function_Return iResult
76304>>>>>>>    End_Function // CreateConnectionID
76305>>>>>>>
76305>>>>>>>
76305>>>>>>>
76305>>>>>>>    //***
76305>>>>>>>    //*** Function: DeleteConnectionID
76305>>>>>>>    //*** Purpose : Delete a DataFlex side connection id.
76305>>>>>>>    //***
76305>>>>>>>
76305>>>>>>>    Function DeleteConnectionID String sID Integer iIndex Returns Integer
76307>>>>>>>        Local String  sDriver
76307>>>>>>>        Local Integer iResult
76307>>>>>>>        Local String sVoid
76307>>>>>>>
76307>>>>>>>        Get psDriverID To sDriver
76308>>>>>>>        If (sDriver <> "") Begin
76310>>>>>>>            Call_Driver 0 sDriver Function CLI_DELETECONNECTIONID Callback 0 Passing sID sVoid iIndex Result iResult
76315>>>>>>>        End
76315>>>>>>>>
76315>>>>>>>        Function_Return iResult
76316>>>>>>>    End_Function // DeleteConnectionID
76317>>>>>>>
76317>>>>>>>End_Class // cCLIHandler
76318>>>>>Use DFBTRDRV.PKG
Including file: DFBTRDRV.PKG    (C:\Program Files (x86)\DataFlex 18.2\Pkg\DFBTRDRV.PKG)
76318>>>>>>>//****************************************************************************
76318>>>>>>>//
76318>>>>>>>// $File name  : DFBTRDRV.PKG
76318>>>>>>>// $File title : Package for the DataFlex Connectivity Kit for Pervasive.SQL
76318>>>>>>>// Notice      : This package contains constants and commands, used to call
76318>>>>>>>//               specific functions in the DFBTRDRV.
76318>>>>>>>// $Author(s)  : Eddy Kleinjan
76318>>>>>>>//
76318>>>>>>>// $System     : DataFlex Connectivity Kit for Pervasive.SQL
76318>>>>>>>// Created     : 01-07-97 @ 12:00:00
76318>>>>>>>//
76318>>>>>>>// Changed     : 04-04-2001.
76318>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.145
76318>>>>>>>//
76318>>>>>>>// Changed     : June 6, 2001
76318>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.148
76318>>>>>>>//
76318>>>>>>>//               Added DFBTR_DDF_OWNER command.
76318>>>>>>>//
76318>>>>>>>// Changed     : June 12, 2001
76318>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.149
76318>>>>>>>//
76318>>>>>>>//               Added DF_FIELD_IS_NULL and DF_FIELD_NULL_ALLOWED attributes
76318>>>>>>>//
76318>>>>>>>// Changed     : August 4, 2004
76318>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 3.0.0.1
76318>>>>>>>//
76318>>>>>>>//               Added cDfbtrdrvHandler class.
76318>>>>>>>//               New functions in this class:
76318>>>>>>>//                  Function CKRevision Returns String
76318>>>>>>>//                  Function CkUsesUri Returns Integer
76318>>>>>>>//                  Function PSQLRequesterVersionInfo Integer iFileNum Returns String
76318>>>>>>>//                  Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
76318>>>>>>>//                  Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
76318>>>>>>>//
76318>>>>>>>// Changed     : September 30, 2005
76318>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 3.0.0.14
76318>>>>>>>//
76318>>>>>>>//               Bugfix: Prevent compiler errors when no (df)error.pkg is used
76318>>>>>>>//****************************************************************************
76318>>>>>>>Use Ui
76318>>>>>>>//
76318>>>>>>>// Driver Indentification
76318>>>>>>>//
76318>>>>>>>
76318>>>>>>>//*** Driver attributes
76318>>>>>>>//
76318>>>>>>>// Call_Driver functions ID's
76318>>>>>>>//
76318>>>>>>>//
76318>>>>>>>// DFBTRFN_CONVERT_FILE options
76318>>>>>>>//
76318>>>>>>>
76318>>>>>>>//
76318>>>>>>>// DFBTRFN_SET_OWNER options
76318>>>>>>>//
76318>>>>>>>
76318>>>>>>>//
76318>>>>>>>// DFBTRFN_SET_TRANSACTION_TYPE options
76318>>>>>>>//
76318>>>>>>>
76318>>>>>>>
76318>>>>>>>//
76318>>>>>>>// Command to create all vars which may be needed
76318>>>>>>>// in other commands.
76318>>>>>>>//
76318>>>>>>>
76318>>>>>>>
76318>>>>>>>
76318>>>>>>>//
76318>>>>>>>// Command to set the owner of a Btrieve file.
76318>>>>>>>// File must have been opened.
76318>>>>>>>// Filenumber needs to be passed.
76318>>>>>>>// To clear set the owner to "".
76318>>>>>>>// Examples:
76318>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret"
76318>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY CALLBACK MyCallBack
76318>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" ENCRYPT
76318>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY ENCRYPT CALLBACK MyCallBack
76318>>>>>>>// To clear:
76318>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to ""
76318>>>>>>>//
76318>>>>>>>
76318>>>>>>>
76318>>>>>>>
76318>>>>>>>//
76318>>>>>>>// Command to parse DFBTR_SET_OWNVER
76318>>>>>>>// options.
76318>>>>>>>//
76318>>>>>>>
76318>>>>>>>
76318>>>>>>>
76318>>>>>>>//
76318>>>>>>>// Command to parse for Callback
76318>>>>>>>//
76318>>>>>>>
76318>>>>>>>
76318>>>>>>>
76318>>>>>>>//
76318>>>>>>>// Command to clear the owner of a Btrieve file.
76318>>>>>>>// File must have been opened.
76318>>>>>>>// Filenumber needs to be passed.
76318>>>>>>>// Examples:
76318>>>>>>>//      DFBTR_CLEAR_OWNER MyFileNumber
76318>>>>>>>//
76318>>>>>>>
76318>>>>>>>
76318>>>>>>>
76318>>>>>>>//
76318>>>>>>>// Command to add a owner name to the internal list of ownernames
76318>>>>>>>// which will be tries when opening files.
76318>>>>>>>//
76318>>>>>>>
76318>>>>>>>
76318>>>>>>>
76318>>>>>>>//
76318>>>>>>>// Command to remove all owners from the internal list of ownernames
76318>>>>>>>//
76318>>>>>>>
76318>>>>>>>
76318>>>>>>>//
76318>>>>>>>// Command to set the owner name to be used when opening the DDF files.
76318>>>>>>>// The DDF owner is required when Pervasive.SQL security is turned on.
76318>>>>>>>// The DDF owner is equal to the password of the Master user in Pervasive.SQL
76318>>>>>>>// This command overwrites the DDF_OWNER setting in DFBTRDRV.INT
76318>>>>>>>//
76318>>>>>>>
76318>>>>>>>//
76318>>>>>>>// Command to change the transaction type.
76318>>>>>>>// Valid types are:
76318>>>>>>>//     DFBTRTT_NONE
76318>>>>>>>//     DFBTRTT_EXCLUSIVE
76318>>>>>>>//     DFBTRTT_CONCURRENT
76318>>>>>>>//
76318>>>>>>>//
76318>>>>>>>
76318>>>>>>>
76318>>>>>>>
76318>>>>>>>//
76318>>>>>>>// Command to get the current transaction type.
76318>>>>>>>//
76318>>>>>>>
76318>>>>>>>//
76318>>>>>>>// Command to set explicit_locking
76318>>>>>>>//
76318>>>>>>>
76318>>>>>>>//
76318>>>>>>>// Command to get explicit locking
76318>>>>>>>//
76318>>>>>>>
76318>>>>>>>//
76318>>>>>>>// Command to set detection for incompatible positive signs in numeric fields
76318>>>>>>>//
76318>>>>>>>
76318>>>>>>>//
76318>>>>>>>// Command to get detection for incompatible positive signs in numeric fields
76318>>>>>>>//
76318>>>>>>>
76318>>>>>>>//*****************************************************************************
76318>>>>>>>//*** Class  : cDfbtrdrvHandler                                                  ***
76318>>>>>>>//*** Purpose: An instance of this class can be used as a broker object to  ***
76318>>>>>>>//***          call several Dfbtrdrv releated methods.                           ***
76318>>>>>>>//*****************************************************************************
76318>>>>>>>
76318>>>>>>>Class cDFBtrDrvHandler Is An Array
76319>>>>>>>
76319>>>>>>>    Procedure Construct_Object Integer iImage
76321>>>>>>>        Forward Send Construct_object iImage
76323>>>>>>>
76323>>>>>>>        Property String  psDriverID       Public "DFBTRDRV"
76324>>>>>>>    End_Procedure // Construct_Object
76325>>>>>>>
76325>>>>>>>
76325>>>>>>>
76325>>>>>>>    //***
76325>>>>>>>    //*** Function: CKRevsion
76325>>>>>>>    //*** Purpose : The revsion of a Dfbtrdrv Connectivity Kit
76325>>>>>>>    //***
76325>>>>>>>
76325>>>>>>>    Function CKRevision Returns String
76327>>>>>>>        Local String  sDriverID
76327>>>>>>>        Local String  sRevision
76327>>>>>>>        Local String  sVoid
76327>>>>>>>        Local Integer iRetval
76327>>>>>>>
76327>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76327>>>>>>>        // This error would otherwise be raised when we have an older
76327>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76327>>>>>>>        Send Ignore_error To Error_object_Id 20491
76328>>>>>>>        Get psDriverID To sDriverID
76329>>>>>>>        Move (Repeat(" ", 255)) To sRevision
76330>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
76335>>>>>>>        Send Trap_Error To Error_object_Id 20491
76336>>>>>>>        If (Trim(sRevision) = "") Begin
76338>>>>>>>            // Unable to get the revision. return all zeroes.
76338>>>>>>>            Move "0.0.0.0" To sRevision
76339>>>>>>>        End
76339>>>>>>>>
76339>>>>>>>        Function_Return sRevision
76340>>>>>>>    End_Function // CKRevision
76341>>>>>>>
76341>>>>>>>    Function CkUsesUri Returns Integer
76343>>>>>>>        Local String  sDriverID
76343>>>>>>>        Local String  sVoid1
76343>>>>>>>        Local String  sVoid2
76343>>>>>>>        Local Integer iRetval
76343>>>>>>>
76343>>>>>>>        Get psDriverID To sDriverID
76344>>>>>>>
76344>>>>>>>        Move 0 To iRetval
76345>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76345>>>>>>>        // This error would otherwise be raised when we have an older
76345>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKUSESURI function
76345>>>>>>>        Send Ignore_error To Error_object_Id 20491
76346>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKUSESURI Callback 0 Passing sVoid1 sVoid2 0 Result iRetval
76351>>>>>>>        Send Trap_Error To Error_object_Id 20491
76352>>>>>>>
76352>>>>>>>        Function_Return iRetval
76353>>>>>>>    End_Function // CKUsesUri
76354>>>>>>>
76354>>>>>>>
76354>>>>>>>
76354>>>>>>>    //***
76354>>>>>>>    //*** Function: ExtractPartFromRevsion
76354>>>>>>>    //*** Purpose : Extarct the Nth part of a a.b.c.d revsion string.
76354>>>>>>>    //***
76354>>>>>>>    //*** Returns : The part version number or -1 if there is no such part number.
76354>>>>>>>    //***
76354>>>>>>>
76354>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
76356>>>>>>>        Local Integer iPartRev
76356>>>>>>>        Local Integer iCurrentPart
76356>>>>>>>        Local Integer iSeparatorPos
76356>>>>>>>
76356>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
76359>>>>>>>
76359>>>>>>>        Move 0 To iCurrentPart
76360>>>>>>>        Repeat
76360>>>>>>>>
76360>>>>>>>            Move (Pos(".", sRevision)) To iSeparatorPos
76361>>>>>>>            If (iSeparatorPos > 0) Begin
76363>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) To iPartRev
76364>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) To sRevision
76365>>>>>>>                Increment iCurrentPart
76366>>>>>>>            End
76366>>>>>>>>
76366>>>>>>>            Else If (sRevision <> "") Begin
76369>>>>>>>                Move sRevision To iPartRev
76370>>>>>>>                Move "" To sRevision
76371>>>>>>>                Increment iCurrentPart
76372>>>>>>>            End
76372>>>>>>>>
76372>>>>>>>            Else ;                Move -1 To iPartRev
76374>>>>>>>        Until (iCurrentPart >= iPartNum Or iPartRev = -1)
76376>>>>>>>
76376>>>>>>>        Function_Return iPartRev
76377>>>>>>>    End_Function // EcxtractPartFromRevision
76378>>>>>>>
76378>>>>>>>
76378>>>>>>>
76378>>>>>>>    //***
76378>>>>>>>    //*** Function: CKMajorRevision
76378>>>>>>>    //*** Purpose : Returns the major revision of the CK
76378>>>>>>>    //***
76378>>>>>>>
76378>>>>>>>    Function CKMajorRevision Returns Integer
76380>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
76381>>>>>>>    End_Function // CKMajorRevision
76382>>>>>>>
76382>>>>>>>
76382>>>>>>>
76382>>>>>>>    //***
76382>>>>>>>    //*** Function: CKMinorRevision
76382>>>>>>>    //*** Purpose : Returns the minor revision of the CK
76382>>>>>>>    //***
76382>>>>>>>
76382>>>>>>>    Function CKMinorRevision Returns Integer
76384>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
76385>>>>>>>    End_Function // CKMinorRevision
76386>>>>>>>
76386>>>>>>>
76386>>>>>>>
76386>>>>>>>    //***
76386>>>>>>>    //*** Function: CKReleaseRevision
76386>>>>>>>    //*** Purpose : Returns the release revision of the CK
76386>>>>>>>    //***
76386>>>>>>>
76386>>>>>>>    Function CKReleaseRevision Returns Integer
76388>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
76389>>>>>>>    End_Function // CKReleaseRevision
76390>>>>>>>
76390>>>>>>>
76390>>>>>>>
76390>>>>>>>    //***
76390>>>>>>>    //*** Function: CKBuildRevision
76390>>>>>>>    //*** Purpose : Returns the major revision of the CK
76390>>>>>>>    //***
76390>>>>>>>
76390>>>>>>>    Function CKBuildRevision Returns Integer
76392>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
76393>>>>>>>    End_Function // CKBuildRevision
76394>>>>>>>
76394>>>>>>>
76394>>>>>>>
76394>>>>>>>    //***
76394>>>>>>>    //*** Function: IsMinimalRevision
76394>>>>>>>    //*** Purpose : Determines if the CK conforms to a passed minimal revsion.
76394>>>>>>>    //***
76394>>>>>>>
76394>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
76396>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_return (TRUE)
76399>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
76402>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_return (TRUE)
76405>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
76408>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_return (TRUE)
76411>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) And iBuild <= CKBuildRevision(Current_object)) ;                    Function_return (TRUE)
76415>>>>>>>            End
76415>>>>>>>>
76415>>>>>>>        End
76415>>>>>>>>
76415>>>>>>>
76415>>>>>>>        Function_Return (FALSE)
76416>>>>>>>    End_Function // IsMinimalRevision
76417>>>>>>>
76417>>>>>>>    //   Functions to query the Pervasive.SQL version:
76417>>>>>>>    //       PSQLRequesterVersionInfo    Integer iFileNum Returns String
76417>>>>>>>    //       PSQLLocalEngineVersionInfo  Integer iFileNum Returns String
76417>>>>>>>    //       PSQLServerEngineVersionInfo Integer iFileNum Returns String
76417>>>>>>>    //
76417>>>>>>>    //   All 3 functions return the version of a Pervasive.SQL component
76417>>>>>>>    //   in the following format:
76417>>>>>>>    //       <version>.<revision>.<type>
76417>>>>>>>    //   possible values for <type>:
76417>>>>>>>    //       9 for 32-bit Windows workstation/workgroup engine or Linux
76417>>>>>>>    //         server using Workgroup authentication mode
76417>>>>>>>    //       C for client cache engine
76417>>>>>>>    //       D for DOS workstation
76417>>>>>>>    //       N for client Requester
76417>>>>>>>    //       S for NetWare server
76417>>>>>>>    //       T for 32-bit Windows server engine
76417>>>>>>>    //       U for Linux server using PAM or BTPASSWD authentication
76417>>>>>>>    //
76417>>>>>>>    //   example:
76417>>>>>>>    //       8.50.T
76417>>>>>>>    //   will be returned for a Pervasive.SQL 8.5 Server Engine running on
76417>>>>>>>    //   32-bits Windows server.
76417>>>>>>>    //
76417>>>>>>>    //   The FileNumber parameter must specify an opened table or 0.
76417>>>>>>>    //   For PSQLServerEngineVersionInfo the FileNumber can not be 0.
76417>>>>>>>    //
76417>>>>>>>    //   If the version information is not available or can not be obtained
76417>>>>>>>    //   the functions will return "0.0.0"
76417>>>>>>>
76417>>>>>>>
76417>>>>>>>    //***
76417>>>>>>>    //*** Function: PSQLRequesterVersionInfo
76417>>>>>>>    //*** Purpose : Returns the version information of the
76417>>>>>>>    //***           Pervasive.SQL Client requester.
76417>>>>>>>
76417>>>>>>>    Function PSQLRequesterVersionInfo Integer iFileNum Returns String
76419>>>>>>>
76419>>>>>>>        Local String  sDriverID
76419>>>>>>>        Local String  sVersion
76419>>>>>>>        Local String  sVoid
76419>>>>>>>        Local Integer iRetval
76419>>>>>>>
76419>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76419>>>>>>>        // This error would otherwise be raised when we have an older
76419>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76419>>>>>>>        Send Ignore_error To Error_object_Id 20491
76420>>>>>>>        Get psDriverID To sDriverID
76421>>>>>>>        Move (Repeat(" ", 255)) To sVersion
76422>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLREQUESTERVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
76427>>>>>>>        Send Trap_Error To Error_object_Id 20491
76428>>>>>>>        If (Trim(sVersion) = "") Begin
76430>>>>>>>            // Unable to get the revision. return all zeroes.
76430>>>>>>>            Move "0.0.0" To sVersion
76431>>>>>>>        End
76431>>>>>>>>
76431>>>>>>>        Function_Return sVersion
76432>>>>>>>    End_Function //  PSQLRequesterVersion
76433>>>>>>>
76433>>>>>>>    //***
76433>>>>>>>    //*** Function: PSQLLocalEngineVersionInfo
76433>>>>>>>    //*** Purpose : Returns the version information of the
76433>>>>>>>    //***           Pervasive.SQL Local Engine
76433>>>>>>>
76433>>>>>>>    Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
76435>>>>>>>
76435>>>>>>>        Local String  sDriverID
76435>>>>>>>        Local String  sVersion
76435>>>>>>>        Local String  sVoid
76435>>>>>>>        Local Integer iRetval
76435>>>>>>>
76435>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76435>>>>>>>        // This error would otherwise be raised when we have an older
76435>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76435>>>>>>>        Send Ignore_error To Error_object_Id 20491
76436>>>>>>>        Get psDriverID To sDriverID
76437>>>>>>>        Move (Repeat(" ", 255)) To sVersion
76438>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLLOCALENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
76443>>>>>>>        Send Trap_Error To Error_object_Id 20491
76444>>>>>>>        If (Trim(sVersion) = "") Begin
76446>>>>>>>            // Unable to get the revision. return all zeroes.
76446>>>>>>>            Move "0.0.0" To sVersion
76447>>>>>>>        End
76447>>>>>>>>
76447>>>>>>>        Function_Return sVersion
76448>>>>>>>    End_Function //  PSQLLocalEngineVersion
76449>>>>>>>
76449>>>>>>>    //***
76449>>>>>>>    //*** Function: PSQLServerEngineVersionInfo
76449>>>>>>>    //*** Purpose : Returns the version information of the
76449>>>>>>>    //***           Pervasive.SQL Server Engine
76449>>>>>>>
76449>>>>>>>    Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
76451>>>>>>>
76451>>>>>>>        Local String  sDriverID
76451>>>>>>>        Local String  sVersion
76451>>>>>>>        Local String  sVoid
76451>>>>>>>        Local Integer iRetval
76451>>>>>>>
76451>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76451>>>>>>>        // This error would otherwise be raised when we have an older
76451>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76451>>>>>>>        Send Ignore_error To Error_object_Id 20491
76452>>>>>>>        Get psDriverID To sDriverID
76453>>>>>>>        Move (Repeat(" ", 255)) To sVersion
76454>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLSERVERENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
76459>>>>>>>        Send Trap_Error To Error_object_Id 20491
76460>>>>>>>        If (Trim(sVersion) = "") Begin
76462>>>>>>>            // Unable to get the revision. return all zeroes.
76462>>>>>>>            Move "0.0.0" To sVersion
76463>>>>>>>        End
76463>>>>>>>>
76463>>>>>>>        Function_Return sVersion
76464>>>>>>>    End_Function //  PSQLServerEngineVersion
76465>>>>>>>
76465>>>>>>>End_Class // cDfbtrdrvHandler
76466>>>>>>>
76466>>>>>
76466>>>>>
76466>>>>>External_Function WNetGetUser "WNetGetUserA" MPR.DLL Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
76467>>>>>
76467>>>>>Register_Function phoWorkspace Returns Handle
76467>>>>>Register_Function Help_filename Returns String
76467>>>>>Register_Function GetHelpFile Returns String
76467>>>>>Register_Function pbEnterKeyAsTabKey Returns Boolean
76467>>>>>
76467>>>>>//****************************************************************************
76467>>>>>// $Module type: FUNCTION
76467>>>>>// $Module name: Network_User_Name
76467>>>>>// $Author     : AK/VOO/KCR
76467>>>>>// Created     : 09-24-96 @ 19:17
76467>>>>>//
76467>>>>>// Description
76467>>>>>//    This function reads the current username Of windows and returns that
76467>>>>>//    name or an text unknown user
76467>>>>>//
76467>>>>>// $Rev History
76467>>>>>//  02/22/2012  Ask Windows how long the size of the name should be
76467>>>>>//  07/25/2003  Replaced obsolete code
76467>>>>>//  09/24/1996  Module header created
76467>>>>>//****************************************************************************
76467>>>>>Function Network_User_Name for cDesktop Returns String
76469>>>>>    String sName
76469>>>>>    Integer iRetval iLength
76469>>>>>
76469>>>>>    Move 0 to iLength
76470>>>>>    Move (WNetGetUser (0, 0, AddressOf (iLength))) to iRetval
76471>>>>>    ZeroString iLength to sName
76472>>>>>    Move (WNetGetUser (0, AddressOf (sName), AddressOf (iLength))) to iRetval
76473>>>>>
76473>>>>>    If (iRetval = NO_ERROR) Begin
76475>>>>>        Function_Return (CString (sName))
76476>>>>>    End
76476>>>>>>
76476>>>>>    
76476>>>>>    Function_Return "User Unknown"
76477>>>>>End_Function
76478>>>>>
76478>>>>>// OBSOLETE STRUCTURE AND WINDOWS API CALL. KEPT FOR BACKWARDS COMPATIBILITY
76478>>>>>Type MEMORYSTATUS
76478>>>>>   Field MEMORYSTATUS.dwLength         as DWord // sizeof(MEMORYSTATUS)
76478>>>>>   Field MEMORYSTATUS.dwMemoryLoad     as DWord // percent Of memory in use
76478>>>>>   Field MEMORYSTATUS.dwTotalPhys      as DWord // bytes Of physical memory
76478>>>>>   Field MEMORYSTATUS.dwAvailPhys      as DWord // free physical memory bytes
76478>>>>>   Field MEMORYSTATUS.dwTotalPageFile  as DWord // bytes Of paging file
76478>>>>>   Field MEMORYSTATUS.dwAvailPageFile  as DWord // free bytes Of paging file
76478>>>>>   Field MEMORYSTATUS.dwTotalVirtual   as DWord // user bytes Of address space
76478>>>>>   Field MEMORYSTATUS.dwAvailVirtual   as DWord // free user bytes
76478>>>>>End_Type // MEMORYSTATUS
76478>>>>>
76478>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
76479>>>>>
76479>>>>>Struct tWinMemoryStatusEx
76479>>>>>    UInteger dwLength                
76479>>>>>    UInteger dwMemoryLoad          
76479>>>>>    UBigInt ullTotalPhys           
76479>>>>>    UBigInt ullAvailPhys           
76479>>>>>    UBigInt ullTotalPageFile       
76479>>>>>    UBigInt ullAvailPageFile       
76479>>>>>    UBigInt ullTotalVirtual        
76479>>>>>    UBigInt ullAvailVirtual        
76479>>>>>    UBigInt ullAvailExtendedVirtual
76479>>>>>End_Struct
76479>>>>>
76479>>>>>External_Function GlobalMemoryStatusEx "GlobalMemoryStatusEx" Kernel32.Dll Pointer lpMemoryStatus Returns Integer
76480>>>>>
76480>>>>>Class SysinfoDisplay is a cTextEdit
76481>>>>>    Procedure Construct_Object
76483>>>>>        Forward Send Construct_Object
76485>>>>>
76485>>>>>        Set Location To 6 6
76486>>>>>        Set Size To 110 255
76487>>>>>        Set Read_Only_State To True
76488>>>>>        Set pbWrap to False
76489>>>>>    End_Procedure
76490>>>>>
76490>>>>>    //****************************************************************************
76490>>>>>    // $Module type: PROCEDURE
76490>>>>>    // $Module name: Show_Current_Directory
76490>>>>>    // $Author     : VOO
76490>>>>>    // Created     : 06-10-96 @ 15:24
76490>>>>>    //
76490>>>>>    // Description
76490>>>>>    //    This method will show the name Of the current directory in the system
76490>>>>>    //    information box
76490>>>>>    //
76490>>>>>    // $Rev History
76490>>>>>    //    06-10-96  Module header created
76490>>>>>    //****************************************************************************
76490>>>>>    Procedure Show_Current_Directory
76492>>>>>        String sDir
76492>>>>>
76492>>>>>        Get_Current_Directory To sDir
76493>>>>>
76493>>>>>        Send AppendTextLn (SFormat (C_$CurrentDirectory, sDir))
76494>>>>>    End_Procedure
76495>>>>>
76495>>>>>    Procedure Show_Windows_Directory
76497>>>>>        String sWindir
76497>>>>>
76497>>>>>        Get_Windows_Directory To sWindir
76498>>>>>
76498>>>>>        Send AppendTextLn (SFormat (C_$WindowsDirectory, sWindir))
76499>>>>>    End_Procedure
76500>>>>>
76500>>>>>    Procedure Show_Current_User
76502>>>>>        Send AppendTextLn (SFormat (C_$NetworkUserName, Network_User_Name (Self)))
76503>>>>>    End_Procedure
76504>>>>>
76504>>>>>    Procedure Show_Number_Format
76506>>>>>        Integer iFormat
76506>>>>>        String sFormatText
76506>>>>>
76506>>>>>        Get_Attribute DF_THOUSANDS_SEPARATOR to iFormat
76509>>>>>        Move (Character (iFormat)) To sFormatText
76510>>>>>        Send AppendTextLn (SFormat (C_$ThousandsSeparator, sFormatText, iFormat))
76511>>>>>
76511>>>>>        Get_Attribute DF_DECIMAL_SEPARATOR to iFormat
76514>>>>>        Move (Character (iFormat)) to sFormatText
76515>>>>>        Send AppendTextLn (SFormat (C_$DecimalSeparator, sFormatText))
76516>>>>>    End_Procedure
76517>>>>>
76517>>>>>    Procedure Show_Filelist_Name
76519>>>>>        String sFilename
76519>>>>>
76519>>>>>        Get_Attribute DF_FILELIST_NAME to sFilename
76522>>>>>
76522>>>>>        Send AppendTextLn (SFormat (C_$CurrentFilelist, sFilename))
76523>>>>>        Send AppendTextLn ""
76524>>>>>    End_Procedure
76525>>>>>
76525>>>>>    Procedure Show_Lock_Delay
76527>>>>>        Integer iLockdelay
76527>>>>>
76527>>>>>        Get_Attribute DF_LOCK_DELAY to iLockdelay
76530>>>>>
76530>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingDelay, iLockDelay))
76531>>>>>    End_Procedure
76532>>>>>
76532>>>>>    Procedure Show_Lock_Timeout
76534>>>>>        Integer iLockTimeout
76534>>>>>
76534>>>>>        Get_Attribute DF_LOCK_TIMEOUT to iLockTimeout
76537>>>>>
76537>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingTimeout, iLockTimeOut))
76538>>>>>    End_Procedure
76539>>>>>
76539>>>>>    Procedure Show_Screen_Size
76541>>>>>        Integer iYscreensize iXscreensize
76541>>>>>
76541>>>>>        Move (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
76542>>>>>        Move (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
76543>>>>>
76543>>>>>        Send AppendTextLn (SFormat (C_$VideoResolution, iXscreensize, iYscreensize))
76544>>>>>    End_Procedure
76545>>>>>
76545>>>>>    Procedure Show_Page_Size
76547>>>>>        Send AppendTextLn (SFormat (C_$PageEndFormFeed, Pageend, Pagefeed))
76548>>>>>    End_procedure
76549>>>>>
76549>>>>>    Procedure Show_Date
76551>>>>>        Date dToday
76551>>>>>
76551>>>>>        Sysdate dToday
76552>>>>>
76552>>>>>        Send AppendTextLn (SFormat (C_$CurrentSystemDate, String (dToday)))
76553>>>>>    End_procedure
76554>>>>>
76554>>>>>    Procedure Show_Date_Format
76556>>>>>        Integer iDateFormat
76556>>>>>        String sDateFormat
76556>>>>>
76556>>>>>        Get_Attribute DF_DATE_FORMAT to iDateFormat
76559>>>>>        Case Begin
76559>>>>>            Case (iDateFormat = DF_DATE_USA)
76561>>>>>                Move C_$USA To sDateFormat
76562>>>>>                Case Break
76563>>>>>            Case (iDateFormat = DF_DATE_EUROPEAN)
76566>>>>>                Move C_$European To sDateFormat
76567>>>>>                Case Break
76568>>>>>            Case (iDateFormat = DF_DATE_MILITARY)
76571>>>>>                Move C_$Military To sDateFormat
76572>>>>>                Case Break
76573>>>>>            Case Else
76573>>>>>                Move C_$UnknownDateType To sDateFormat
76574>>>>>                Case Break
76575>>>>>        Case End
76575>>>>>
76575>>>>>        Send AppendTextLn (SFormat (C_$DateFormat, sDateformat))
76576>>>>>    End_Procedure
76577>>>>>
76577>>>>>    Procedure Show_Systemresources
76579>>>>>        tWinMemoryStatusEx MemoryStatusInfo
76579>>>>>        tWinMemoryStatusEx MemoryStatusInfo
76579>>>>>        Integer iRetval
76579>>>>>
76579>>>>>        Move (SizeOfType (tWinMemoryStatusEx)) to MemoryStatusInfo.dwLength
76580>>>>>        Move (GlobalMemoryStatusEx (AddressOf (MemoryStatusInfo))) to iRetval
76581>>>>>        If (iRetval = 0) Begin
76583>>>>>            Move (ShowLastError ()) to iRetval
76584>>>>>        End
76584>>>>>>
76584>>>>>
76584>>>>>        Send AppendTextLn (SFormat (C_$AvailableMemory, MemoryStatusInfo.ullTotalPhys))
76585>>>>>        Send AppendTextLn (SFormat (C_$MemoryUtilization, MemoryStatusInfo.dwMemoryLoad))
76586>>>>>        Send AppendTextLn (SFormat (C_$AvailablePhysicalMemory, Real (MemoryStatusInfo.ullAvailPhys) / Real (MemoryStatusInfo.ullTotalPhys) * 100.0))
76587>>>>>        Send AppendTextLn (SFormat (C_$AvailablePagefileSpace, Real (MemoryStatusInfo.ullAvailPageFile) / Real (MemoryStatusInfo.ullTotalPageFile) * 100.0))
76588>>>>>        Send AppendTextLn (SFormat (C_$AvailableVirtualMemory, Real (MemoryStatusInfo.ullAvailVirtual) / Real (MemoryStatusInfo.ullTotalVirtual) * 100.0))
76589>>>>>    End_Procedure
76590>>>>>
76590>>>>>    Procedure Show_Registration
76592>>>>>        String sRegName
76592>>>>>        Integer iSN iMaxUsers
76592>>>>>
76592>>>>>        Registration sRegName iSN
76593>>>>>>
76593>>>>>        
76593>>>>>        Get_Licensed_Max_Users to iMaxUsers
76594>>>>>
76594>>>>>        Send AppendTextLn ""
76595>>>>>        Send AppendTextLn (SFormat (C_$Serial, iSN))
76596>>>>>        Send AppendTextLn (SFormat (C_$RegName, sRegName))
76597>>>>>        Send AppendTextLn (SFormat (C_$MaxNumUsers, iMaxUsers))
76598>>>>>    End_Procedure
76599>>>>>
76599>>>>>    //****************************************************************************
76599>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
76599>>>>>    // To the workspace object passing the an object and message To send back
76599>>>>>    // To this object. It is expected that the workspace object will send this
76599>>>>>    // message for every line Of information it wants displayed (passing the
76599>>>>>    // information To be displayed
76599>>>>>    //****************************************************************************
76599>>>>>    Register_Procedure EnumerateWorkspaceData Integer hObjId Integer hmMessId
76599>>>>>
76599>>>>>    Procedure Show_ServicePack
76601>>>>>        String sKey sVersionDescription sVersion 
76601>>>>>        Handle hoRegistry
76601>>>>>        Boolean bExists bOpened
76601>>>>>        
76601>>>>>        Get Create (RefClass (cRegistry)) to hoRegistry
76602>>>>>        Set phRootKey of hoRegistry to HKEY_LOCAL_MACHINE
76603>>>>>        Set pfAccessRights of hoRegistry to KEY_READ
76604>>>>>
76604>>>>>        Move C_DFVersionRegistryRoot to sKey
76605>>>>>        Get KeyExists of hoRegistry sKey to bExists
76606>>>>>        If (bExists) Begin
76608>>>>>            Get OpenKey of hoRegistry sKey to bOpened
76609>>>>>            If (bOpened) Begin
76611>>>>>                Get ValueExists of hoRegistry "CurrentVersionDescription" to bExists
76612>>>>>                If (bExists) Begin
76614>>>>>                    Get ReadString of hoRegistry "CurrentVersionDescription" to sVersionDescription
76615>>>>>                End
76615>>>>>>
76615>>>>>                
76615>>>>>                Get ValueExists of hoRegistry "CurrentVersion" to bExists
76616>>>>>                If (bExists) Begin
76618>>>>>                    Get ReadString of hoRegistry "CurrentVersion" to sVersion
76619>>>>>                End                
76619>>>>>>
76619>>>>>                Send CloseKey of hoRegistry
76620>>>>>            End
76620>>>>>>
76620>>>>>        End
76620>>>>>>
76620>>>>>        Send Destroy of hoRegistry
76621>>>>>
76621>>>>>        If (sVersionDescription <> "") Begin
76623>>>>>           Send AppendTextLn (sVersionDescription * "-" * sVersion)
76624>>>>>           Send AppendTextLn ""
76625>>>>>        End
76625>>>>>>
76625>>>>>    End_Procedure
76626>>>>>    
76626>>>>>
76626>>>>>    Procedure Show_WorkspaceInformation
76628>>>>>        Integer hoWorkspace
76628>>>>>
76628>>>>>        If (ghoApplication <> 0) Begin
76630>>>>>            Get phoWorkspace of ghoApplication to hoWorkspace
76631>>>>>            If (hoWorkspace <> 0) Begin
76633>>>>>                Send EnumerateWorkspaceData of hoWorkspace Self (Refproc (AppendTextLn))
76634>>>>>                Send AppendTextLn ""
76635>>>>>            End
76635>>>>>>
76635>>>>>        End
76635>>>>>>
76635>>>>>    End_Procedure
76636>>>>>
76636>>>>>    Function VersionStr Integer iVer Integer iRev Integer iBld Returns String
76638>>>>>        Function_Return (String (iVer) - "." - String (iRev) - "." - String (iBld))
76639>>>>>    End_Function
76640>>>>>
76640>>>>>    Procedure Show_Versions
76642>>>>>        Integer iVersion iRevision iBuild
76642>>>>>
76642>>>>>        Version_Information iVersion iRevision iBuild
76644>>>>>
76644>>>>>        Send AppendTextLn (SFormat (C_$RuntimeVersion, VersionStr(Self,iVersion,iRevision,iBuild) ))
76645>>>>>        Send AppendTextLn (SFormat (C_$PackageVersion, VersionStr(Self,PKG_VERSION, PKG_REVISION, PKG_BUILD) ))
76646>>>>>        Send AppendTextLn (SFormat (C_$FMACVersion, VersionStr(Self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) ))
76647>>>>>    End_Procedure
76648>>>>>    
76648>>>>>    Function CKRevisionNumber String sDriverID Returns String
76650>>>>>        Handle hoCLIHandler
76650>>>>>        Handle hoDFBtrDrvHandler
76650>>>>>        String sCKRevision
76650>>>>>
76650>>>>>
76650>>>>>        If (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV") Begin
76652>>>>>            Get Create (RefClass(cCLIHandler)) to hoCLIHandler
76653>>>>>            Set psDriverID of hoCLIHandler to sDriverID
76654>>>>>            Move (CKRevision(hoCLIHandler)) to sCKRevision
76655>>>>>            Send Destroy of hoCLIHandler
76656>>>>>        End
76656>>>>>>
76656>>>>>        Else Begin
76657>>>>>            If (sDriverID = "DFBTRDRV") Begin
76659>>>>>                Get Create (RefClass(cDFBtrDrvHandler)) to hoDFBtrDrvHandler
76660>>>>>                Set psDriverID of hoDFBtrDrvHandler to sDriverID
76661>>>>>                Move (CKRevision(hoDFBtrDrvHandler)) to sCKRevision
76662>>>>>                Send Destroy of hoDFBtrDrvHandler
76663>>>>>            End
76663>>>>>>
76663>>>>>        End
76663>>>>>>
76663>>>>>        
76663>>>>>        Function_Return sCKRevision
76664>>>>>    End_Function
76665>>>>>    
76665>>>>>    
76665>>>>>    Function IsDataAccessCK String sDriverID Returns Boolean
76667>>>>>        
76667>>>>>        If (sDriverID = "DATAFLEX") Begin
76669>>>>>            Function_Return False
76670>>>>>        End
76670>>>>>>
76670>>>>>    
76670>>>>>        Function_Return (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV" or sDriverID = "DFBTRDRV")
76671>>>>>    End_Function    
76672>>>>>
76672>>>>>
76672>>>>>    //***
76672>>>>>    //*** BW
76672>>>>>    //*** Procedure: Show_Drivers
76672>>>>>    //*** Purpose  : Show loaded database drivers
76672>>>>>    //***
76672>>>>>
76672>>>>>    Procedure Show_Drivers
76674>>>>>        String sCurrentDriver sRevNumber
76674>>>>>        String sLoadedDrivers
76674>>>>>        Integer iNumberOfDrivers iCount
76674>>>>>        Boolean bOK
76674>>>>>
76674>>>>>        Move "" To sLoadedDrivers
76675>>>>>        Get_Attribute DF_NUMBER_DRIVERS To iNumberOfDrivers
76678>>>>>        For iCount From 1 To iNumberOfDrivers
76684>>>>>>
76684>>>>>            Get_Attribute DF_DRIVER_NAME Of iCount To sCurrentDriver
76687>>>>>            If (sLoadedDrivers <> "") Begin
76689>>>>>                Move (Append (sLoadedDrivers, ", ")) To sLoadedDrivers
76690>>>>>            End
76690>>>>>>
76690>>>>>            Get IsDataAccessCK sCurrentDriver to bOK
76691>>>>>            If (bOK) Begin
76693>>>>>                Get CKRevisionNumber sCurrentDriver to sRevNumber
76694>>>>>                Move (sCurrentDriver * "(" + sRevNumber + ")") to sCurrentDriver
76695>>>>>            End
76695>>>>>>
76695>>>>>            Move (Append (sLoadedDrivers, sCurrentDriver)) To sLoadedDrivers
76696>>>>>        Loop
76697>>>>>>
76697>>>>>        Send AppendTextLn (SFormat (C_$DatabaseDriver, sLoadedDrivers))
76698>>>>>    End_Procedure
76699>>>>>
76699>>>>>    Procedure Show_HelpFile
76701>>>>>        String sHelpFile
76701>>>>>        Integer eHelpType
76701>>>>>
76701>>>>>        If (ghoApplication <> 0) Begin
76703>>>>>            Get peHelpType Of ghoApplication To eHelpType
76704>>>>>            If (eHelpType = htHtmlHelp and ghoHtmlHelp) Begin
76706>>>>>                Get GetHelpFile Of ghoHtmlHelp To sHelpFile
76707>>>>>            End
76707>>>>>>
76707>>>>>            Else If (eHelpType = htWinHelp and Help_object_id) Begin
76710>>>>>                Get Help_filename Of Help_object_id To sHelpFile
76711>>>>>            End
76711>>>>>>
76711>>>>>            Else Begin
76712>>>>>                Move C_$ThereIsNoHelpfileDefined To sHelpFile
76713>>>>>            End
76713>>>>>>
76713>>>>>
76713>>>>>            Send AppendTextLn ""
76714>>>>>            Send AppendTextLn (SFormat (C_$HelpFile, sHelpFile))
76715>>>>>        End
76715>>>>>>
76715>>>>>    End_Procedure
76716>>>>>
76716>>>>>    Procedure Show_EnterAsTab
76718>>>>>        Boolean bEnterKeyAsTabKey
76718>>>>>        String sText
76718>>>>>
76718>>>>>        If (ghoApplication <> 0) Begin
76720>>>>>            Get pbEnterKeyAsTabKey Of ghoApplication To bEnterKeyAsTabKey
76721>>>>>            If (bEnterKeyAsTabKey) Begin
76723>>>>>                Move "True" To sText
76724>>>>>            End
76724>>>>>>
76724>>>>>            Else Begin
76725>>>>>                Move "False" To sText
76726>>>>>            End
76726>>>>>>
76726>>>>>            Send AppendTextLn (SFormat (C_$EnterKeyNavForward, sText))
76727>>>>>        End
76727>>>>>>
76727>>>>>    End_Procedure
76728>>>>>
76728>>>>>    //****************************************************************************
76728>>>>>    // $Module type: PROCEDURE
76728>>>>>    // $Module name: Add_Focus
76728>>>>>    // $Author     : VOO
76728>>>>>    // Created     : 24-09-96 @ 19:43
76728>>>>>    //
76728>>>>>    // Description
76728>>>>>    //    During activation we will remove the old information and add the newly
76728>>>>>    //    found systeminformation
76728>>>>>    //
76728>>>>>    // $Rev History
76728>>>>>    //    24-09-96  Module header created
76728>>>>>    //****************************************************************************
76728>>>>>    Procedure Add_Focus Integer hoRoot
76730>>>>>        Forward Send Add_Focus hoRoot
76732>>>>>
76732>>>>>        Send Delete_Data
76733>>>>>
76733>>>>>        Set Changed_State To False
76734>>>>>        Set Read_Only_State To True
76735>>>>>
76735>>>>>        Send Show_ServicePack
76736>>>>>        Send Show_Versions   
76737>>>>>        Send Show_Drivers         
76738>>>>>        Send Show_HelpFile
76739>>>>>        Send Show_Current_Directory
76740>>>>>        Send Show_Filelist_Name          
76741>>>>>        If (ghoApplication <> 0) Begin
76743>>>>>            Send Show_WorkSpaceInformation // added To show WS info
76744>>>>>        End
76744>>>>>>
76744>>>>>        Send Show_Current_User 
76745>>>>>        Send Show_Windows_Directory 
76746>>>>>        Send Show_Screen_Size
76747>>>>>        Send Show_Page_Size
76748>>>>>        Send Show_EnterAsTab        
76749>>>>>        Send Show_Number_Format
76750>>>>>        Send Show_Date_Format
76751>>>>>        Send Show_Lock_Delay
76752>>>>>        Send Show_Lock_Timeout
76753>>>>>        Send Show_Date
76754>>>>>        Send Show_Systemresources
76755>>>>>        Send Show_Registration
76756>>>>>        Send Beginning_of_Data
76757>>>>>
76757>>>>>        Set Icon to 'default.ico'
76758>>>>>    End_Procedure
76759>>>>>End_Class
76760>>>>>
76760>>>>>//****************************************************************************
76760>>>>>// $Module type: OBJECT
76760>>>>>// $Module name: Sysinfo_Dialog
76760>>>>>// $Author     : VOO
76760>>>>>// Created     : 24-09-96 @ 18:47
76760>>>>>//
76760>>>>>// Description
76760>>>>>//    This object shows the systeminformation on the screen
76760>>>>>//
76760>>>>>// $Rev History
76760>>>>>//    24-09-96  Module header created
76760>>>>>//****************************************************************************
76760>>>>>Class SysInfoDialog Is A ModalPanel
76761>>>>>    Procedure Construct_Object
76763>>>>>        Forward Send Construct_Object
76765>>>>>
76765>>>>>        Set Label to C_$SystemInformation
76766>>>>>        Set Size to 140 267
76767>>>>>        Set piMinSize to 140 267
76768>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
76769>>>>>        Set Border_Style to Border_Thick
76770>>>>>
76770>>>>>        Object oSysinfoDisplay Is A SysInfoDisplay
76772>>>>>            Set peAnchors to anAll
76773>>>>>        End_Object
76774>>>>>
76774>>>>>        Object oCloseButton Is A Button
76776>>>>>            Set Label To C_$Close
76777>>>>>            Set Location To 120 210
76778>>>>>            Set Message Item 0 To (Refproc (Close_Panel))
76779>>>>>            Set Default_State To True
76780>>>>>            Set peAnchors to anBottomRight
76781>>>>>        End_Object
76782>>>>>
76782>>>>>        On_Key kCancel Send Close_Panel
76783>>>>>    End_Procedure
76784>>>>>End_Class
76785>>>>>
76785>>>>>// Purpose:
76785>>>>>//
76785>>>>>// Ken Ross 12/17/96 5:16PM
76785>>>>>//
76785>>>>>Class AboutDialog Is A ModalPanel
76786>>>>>    Procedure Construct_Object
76788>>>>>        String sVdfRootDir
76788>>>>>
76788>>>>>        Forward Send Construct_Object
76790>>>>>
76790>>>>>        Set Label To C_$About
76791>>>>>        Set Size to 89 212
76792>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
76793>>>>>
76793>>>>>        Object oSysInfoDialog Is A SysInfoDialog
76795>>>>>        End_Object
76796>>>>>
76796>>>>>        Object oBox Is A Container3d
76798>>>>>            Set Border_Style To Border_StaticEdge
76799>>>>>            Set Size to 63 202
76800>>>>>            Set Location To 4 5
76801>>>>>
76801>>>>>            Object oAboutGraphic Is A BitmapContainer
76803>>>>>                Set Border_Style To Border_None
76804>>>>>                Set Bitmap_Style To Bitmap_Center
76805>>>>>                Set Size To 48 48
76806>>>>>                Set Location To 7 2
76807>>>>>            End_Object
76808>>>>>
76808>>>>>            Object oProductName Is A TextBox
76810>>>>>                Set Label To C_$ProductName
76811>>>>>                Set Size To 10 45
76812>>>>>                Set Location To 8 53
76813>>>>>            End_Object
76814>>>>>
76814>>>>>            Object oVersion Is A TextBox
76816>>>>>                Set Label To C_$Version
76817>>>>>                Set Size To 10 25
76818>>>>>                Set Location To 21 53
76819>>>>>            End_Object
76820>>>>>
76820>>>>>            Object oCopyright Is A TextBox
76822>>>>>                Set Label To C_$Copyright
76823>>>>>                Set Size To 10 31
76824>>>>>                Set Location To 34 53
76825>>>>>            End_Object
76826>>>>>
76826>>>>>            Object oAuthor Is A TextBox
76828>>>>>                Set Label To C_$Author
76829>>>>>                Set Size To 10 22
76830>>>>>                Set Location To 46 53
76831>>>>>            End_Object
76832>>>>>        End_Object
76833>>>>>
76833>>>>>        Object oOKButton Is A Button
76835>>>>>            On_Item C_$OK Send Close_Panel
76836>>>>>            Set Size To 14 50
76837>>>>>            Set Location To 71 157
76838>>>>>        End_Object
76839>>>>>
76839>>>>>        Object oSysInfoButton Is A Button
76841>>>>>            On_Item C_$SystemInfo Send Show_Sysinfo
76842>>>>>            Set Size To 14 50
76843>>>>>            Set Location To 71 101
76844>>>>>        End_Object
76845>>>>>
76845>>>>>        On_Key Kcancel Send KeyAction Of oOKButton
76846>>>>>
76846>>>>>        Set Logo To "DacAbout.bmp"  // square bitmaps Of 42x42 work best
76847>>>>>    End_Procedure
76848>>>>>
76848>>>>>    Procedure Set ProductName String sProductName
76850>>>>>        Set Label Of oProductName To sProductName
76851>>>>>    End_Procedure
76852>>>>>
76852>>>>>    Procedure Set Version String sVersion
76854>>>>>        Set Label Of oVersion To sVersion
76855>>>>>    End_Procedure
76856>>>>>
76856>>>>>    Procedure Set Copyright string sCopyright
76858>>>>>        Set Label Of oCopyright To sCopyright
76859>>>>>    End_Procedure
76860>>>>>
76860>>>>>    Procedure Set Author String sAuthor
76862>>>>>        Set Label Of oAuthor To sAuthor
76863>>>>>    End_Procedure
76864>>>>>
76864>>>>>    Procedure Set Logo string sLogo
76866>>>>>        // square bitmaps Of 42x42 work best
76866>>>>>        Set Bitmap Of oAboutGraphic To sLogo
76867>>>>>    End_Procedure
76868>>>>>
76868>>>>>    Procedure Show_Sysinfo
76870>>>>>        Send Popup_Modal Of oSysinfoDialog
76871>>>>>    End_Procedure
76872>>>>>
76872>>>>>    Procedure End_Construct_Object
76874>>>>>        Handle hoVersionInfo
76874>>>>>        Boolean bIncluded
76874>>>>>        Integer iMajor iMinor iRelease iBuild
76874>>>>>        String sLabel
76874>>>>>
76874>>>>>        Get Label Of oVersion To sLabel
76875>>>>>        If (sLabel = C_$VERSION) Begin
76877>>>>>            // set it To the version info Of the program, if available
76877>>>>>            If (ghoApplication <> 0) Begin
76879>>>>>                Get phoVersionInfo of ghoApplication to hoVersionInfo
76880>>>>>                If (hoVersionInfo <> 0) Begin
76882>>>>>                    Get pbIncluded of hoVersionInfo to bIncluded
76883>>>>>                    If (bIncluded) Begin
76885>>>>>                        Get piVersionMajor of hoVersionInfo to iMajor
76886>>>>>                        Get piVersionMinor of hoVersionInfo to iMinor
76887>>>>>                        Get piVersionRelease of hoVersionInfo to iRelease
76888>>>>>                        Get piVersionBuild of hoVersionInfo to iBuild
76889>>>>>                        Move (SFormat (C_$VERSION + ": %1.%2.%3.%4", iMajor, iMinor, iRelease, iBuild)) to sLabel
76890>>>>>                        Set Version to sLabel
76891>>>>>                    End
76891>>>>>>
76891>>>>>                End
76891>>>>>>
76891>>>>>            End
76891>>>>>>
76891>>>>>        End
76891>>>>>>
76891>>>>>
76891>>>>>        Forward Send End_Construct_Object
76893>>>>>    End_Procedure
76894>>>>>End_Class
76895>>>
76895>>>// *************************************************************************
76895>>>//  Public message. This is the default message. It is expected that you will
76895>>>//   create your own message to override this
76895>>>// *************************************************************************
76895>>>
76895>>>Procedure Activate_About
76898>>>   Send DoAbout "" "" "" "" ""
76899>>>End_Procedure
76900>>>
76900>>>// *************************************************************************
76900>>>//  Public message. It is expected that you will send this message (most
76900>>>//  likely from Activate_About. This creates an about object, activates it
76900>>>//  and destroys it when done. It is not exepected that you will augment this.
76900>>>// *************************************************************************
76900>>>
76900>>>Procedure DoAbout string sTitle string sVersion string sCopyRight string sAuthor string sBitmap
76903>>>        integer hoObj hoMain
76903>>>
76903>>>        // create object
76903>>>        Object About is an AboutDialog
76905>>>            // if no title passed use the label of the main panel
76905>>>            // (if a main panel exists).
76905>>>            if sTitle     eq '' Begin
76907>>>                Get Main_Window of desktop to hoMain
76908>>>                if hoMain Get Label of hoMain to sTitle
76911>>>            end
76911>>>>
76911>>>            set productname to sTitle
76912>>>            set version     to sVersion
76913>>>            set copyright   to sCopyRight
76914>>>            set author      to sAuthor
76915>>>            If sBitmap    ne '' ;               set logo to sBitMap // square bitmaps of 42x42 work best
76918>>>            Move self to hoObj // object Id
76919>>>        End_Object
76920>>>        Send Popup   of hoObj    // popup the about object
76921>>>        Send Destroy of hoObj // when done, it will be destroyed
76922>>>End_procedure
76923>        Use pantallaPrincipal.vw
Including file: pantallaPrincipal.vw    (C:\GIT\guiProgram\AppSrc\pantallaPrincipal.vw)
76923>>>//**************************************************************
76923>>>// TabbedView.tpl for Windows application for Spanish 
76923>>>// translated by Moose Software (www.moose-software.com) 
76923>>>// 11/11/2008 Revised for VDF 14.1 by Moose Software
76923>>>// 13/07/2010 Revised for VDF 16.0 by Moose Software
76923>>>// 05/02/2012 Revised for VDF 17.0 by Moose Software
76923>>>// 13/06/2013 Revised for VDF 17.1 by Moose Software
76923>>>// 02/05/2014 Revised for VDF 18.0 by Moose Software
76923>>>//*************************************************************
76923>>>
76923>>>Use Windows.pkg
76923>>>Use DFClient.pkg
76923>>>Use DFTabDlg.pkg
76923>>>
76923>>>Activate_View Activate_oPantallaPrincipal for oPantallaPrincipal
76933>>>>
76933>>>Object oPantallaPrincipal is a dbView
76935>>>    Set Label to "Login | SID"
76936>>>    Set Size to 149 250
76937>>>    Set Location to 5 6
76938>>>
76938>>>    Object oTextBox1 is a TextBox
76940>>>        Set Size to 18 33
76941>>>        Set Location to 9 102
76942>>>        Set Label to 'Login | SID'
76943>>>    End_Object
76944>>>
76944>>>    Object ingresoSistema is a Button
76946>>>        Set Size to 14 68
76947>>>        Set Location to 115 57
76948>>>        Set Label to "Ingresar al Sistema"
76949>>>    
76949>>>        // fires when the button is clicked
76949>>>        Procedure OnClick
76952>>>            Send Info_Box "Ingreso correcto, bienvenido" "El Sistema dice: "
76953>>>        End_Procedure
76954>>>    
76954>>>    End_Object
76955>>>
76955>>>    Object oTextBox2 is a TextBox
76957>>>        Set Size to 10 50
76958>>>        Set Location to 44 57
76959>>>        Set Label to "Usuario"
76960>>>    End_Object
76961>>>
76961>>>    Object usuario is a Form
76963>>>        Set Size to 13 109
76964>>>        Set Location to 43 86
76965>>>    
76965>>>        // OnChange is called on every changed character
76965>>>    //    Procedure OnChange
76965>>>    //        String sValue
76965>>>    //    
76965>>>    //        Get Value to sValue
76965>>>    //    End_Procedure
76965>>>    
76965>>>    End_Object
76966>>>
76966>>>    Object oTextBox3 is a TextBox
76968>>>        Set Size to 10 35
76969>>>        Set Location to 73 55
76970>>>        Set Label to "Contrasea"
76971>>>    End_Object
76972>>>
76972>>>    Object contrasena is a Form
76974>>>        Set Size to 13 100
76975>>>        Set Location to 70 95
76976>>>    
76976>>>        // OnChange is called on every changed character
76976>>>    //    Procedure OnChange
76976>>>    //        String sValue
76976>>>    //    
76976>>>    //        Get Value to sValue
76976>>>    //    End_Procedure
76976>>>    
76976>>>    End_Object
76977>>>
76977>>>    Object limpiar is a Button
76979>>>        Set Location to 115 131
76980>>>        Set Label to "Limpiar"
76981>>>    
76981>>>        // fires when the button is clicked
76981>>>        Procedure OnClick
76984>>>            
76984>>>        End_Procedure
76985>>>    
76985>>>    End_Object
76986>>>
76986>>>End_Object
76987>>>
76987>>>//*********************************************** end of tabbedView.tpl for Spanish ****************
76987>
76987>        Procedure Activate_About
76990>            Send DoAbout "" "" "" "" ""
76991>        End_Procedure
76992>
76992>    End_Object
76993>
76993>End_Object
76994>
76994>Start_UI
76995>
76995>//************************** end of WindowsProject.tpl for Spanish **************
76995>
Summary
Memory Available: 2147483646
Total Warnings : 0
Total Errors   : 0
Total Symbols  : 44255
Total Resources: 0
Total Commands : 76994
Total Windows  : 1
Total Pages    : 1
Static Data    : 467041
Message area   : 529100
Total Blocks   : 27666
